;;; test_tower_self_interpreters_typecheck.scm

;;; Defining tests for run-prog-typecheck, run-2-prog-typecheck and run-3-prog-typecheck

(load "~/home/Desktop/Yale NUS stuff/Y4S1/Capstone/Scheme_Capstone/scheme_code/tower_self_interpreters_typecheck.scm")
 
;;; Defining tests for run-prog-typecheck

;;; normal version
(define test-run-prog-typecheck
  (lambda ()
    (begin
      ;;; Testing for base values
      (unless (equal? (run-prog-typecheck 0) 0)
	      (printf "failed: (run-prog-typecheck 0)\n"))
      (unless (equal? (run-prog-typecheck '#f) #f)
	      (printf "failed: (run-prog-typecheck '#f)\n"))
      (unless (equal? (run-prog-typecheck '#\f) #\f)
	      (printf "failed: (run-prog-typecheck '#\f)\n"))
      (unless (equal? (run-prog-typecheck "scheme_capstone") "scheme_capstone")
	      (printf "failed: (run-prog-typecheck \"scheme_capstone\" )\n"))
      (unless (equal? (run-prog-typecheck '()) '())
	      (printf "failed: (run-prog-typecheck '())\n"))
      ;;; Testing for if expressions
      (unless (equal? (run-prog-typecheck '(if #t 1 2)) 1)
	      (printf "failed: (run-prog-typecheck '(if #t 1 2))\n"))
      (unless (equal? (run-prog-typecheck '(if #f 1 2)) 2)
	      (printf "failed: (run-prog-typecheck '(if #f 1 2))\n"))
      (unless (equal? (run-prog-typecheck '(if 0 1 2)) 1)
	      (printf "failed: (run-prog-typecheck '(if 0 1 2))\n"))
      (unless (equal? (run-prog-typecheck '((lambda (x) x) 1)) 1)
	      (printf "failed: (run-prog-typecheck '((lambda (x) x) 1))\n"))
      ;;; Testing for lambda expressions
      (unless (equal? (run-prog-typecheck '((lambda (x y) x) 1 2)) 1)
	      (printf "failed: (run-prog-typecheck '((lambda (x y) x) 1 2))\n"))
      (unless (equal? (run-prog-typecheck '((lambda (x y) x) 1 2)) 1)
	      (printf "failed: (run-prog-typecheck ((lambda (x y) x) 1 2))\n"))
      (unless (equal? (run-prog-typecheck '((lambda (x y) y) 1 2)) 2)
	      (printf "failed: (run-prog-typecheck ((lambda (x y) y) 1 2))\n"))
      (unless (equal? (run-prog-typecheck '((lambda xs xs) 1 2)) '(1 2))
	      (printf "failed: (run-prog-typecheck '((lambda xs xs) 1 2))\n"))
      (unless (equal? (run-prog-typecheck '((lambda (x . xs) xs) 1 2 3)) '(2 3))
	      (printf "failed: (run-prog-typecheck '((lambda (x . xs) xs) 1 2 3))\n"))
      ;;; Testing for let expressions
      (unless (equal? (run-prog-typecheck '(let () 2)) 2)
	      (printf "failed: (run-prog-typecheck '(let () 2))\n"))
      (unless (equal? (run-prog-typecheck '(let ((x 1)) x)) 1)
	      (printf "failed: (run-prog-typecheck '(let ((x 1)) x))\n"))
      (unless (equal? (run-prog-typecheck '(let ((x 1) (y 2)) x)) 1)
	      (printf "failed: (run-prog-typecheck '(let ((x 1) (y 2)) x))\n"))
      (unless (equal? (run-prog-typecheck '(let ((x 1) (y 2)) y)) 2)
	      (printf "failed: (run-prog-typecheck '(let ((x 1) (y 2)) y))\n"))
      ;;; Testing for quote expressions and nested quote expressions
      (unless (equal? (run-prog-typecheck ''(if #t 1 2)) '(if #t 1 2))
	      (printf "failed: (run-prog-typecheck ''(if #t 1 2))\n"))
      (unless (equal? (run-prog-typecheck ''((lambda (x y) x) 1 2))'((lambda (x y) x) 1 2))
	      (printf "failed: (run-prog-typecheck ''((lambda (x y) x) 1 2))\n"))
      (unless (equal? (run-prog-typecheck '''(if #t 1 2)) ''(if #t 1 2))
	      (printf "failed: (run-prog-typecheck '''(if #t 1 2))\n"))
      (unless (equal? (run-prog-typecheck '''((lambda (x y) x) 1 2))''((lambda (x y) x) 1 2))
	      (printf "failed: (run-prog-typecheck '''((lambda (x y) x) 1 2))\n"))
      ;;; Testing for cond expression
      (unless (equal? (run-prog-typecheck '(cond (#t 3)(#f 4)(else 1))) 3)
	      (printf "failed: (run-prog-typecheck '(cond (#t 3)(#f 4)(else 1)))\n"))
      (unless (equal? (run-prog-typecheck '(cond (#f 3)((equal? 5 5) 4)(else 1))) 4)
	      (printf "failed: (run-prog-typecheck '(cond (#f 3)((equal? 5 5) 4)(else 1)))\n"))
      (unless (equal? (run-prog-typecheck '(cond (#t 3)((equal? 5 5) 4)(else 1))) 3)
	      (printf "failed: (run-prog-typecheck '(cond (#t 3)((equal? 5 5) 4)(else 1)))\n"))
      (unless (equal? (run-prog-typecheck '(cond (#f 3)((equal? 5 5) (- 5 3 1))(else 9))) 1)
	      (printf "failed: (run-prog-typecheck '(cond (#f 3)((equal? 5 5) (- 5 3 1))(else 9)))\n"))
      (unless (equal? (run-prog-typecheck '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else (* 10 9)))) 90)
	      (printf "failed: (run-prog-typecheck '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else (* 10 9))))\n"))
      (unless (equal? (run-prog-typecheck '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else 9))) 9)
	      (printf "failed: (run-prog-typecheck '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else 9)))\n"))
      (unless (equal? (run-prog-typecheck '(cond (else 2))) '2)
	      (printf "failed: (run-prog-typecheck '(cond (else 2)))\n"))
      ;;; Testing for mathematical operator primitives
      (unless (equal? (run-prog-typecheck '(+)) 0)
	      (printf "failed: (run-prog-typecheck '(+))\n"))
      (unless (equal? (run-prog-typecheck '(+ 1)) 1)
	      (printf "failed: (run-prog-typecheck '(+ 1))\n"))
      (unless (equal? (run-prog-typecheck '(+ 1 10)) 11)
	      (printf "failed: (run-prog-typecheck '(+ 1 10))\n"))
      (unless (equal? (run-prog-typecheck '(+ 1 10 100)) 111)
	      (printf "failed: (run-prog-typecheck '(+ 1 10 100))\n"))
      (unless (equal? (run-prog-typecheck '(- 5)) -5)
	      (printf "failed: (run-prog-typecheck '(- 5))\n"))
      (unless (equal? (run-prog-typecheck '(- 5 1 2)) 2)
	      (printf "failed: (run-prog-typecheck '(- 5 1 2))\n"))
      (unless (equal? (run-prog-typecheck '(*)) 1)
	      (printf "failed: (run-prog-typecheck '(*))\n"))
      (unless (equal? (run-prog-typecheck '(* 5)) 5)
	      (printf "failed: (run-prog-typecheck '(* 5))\n"))
      (unless (equal? (run-prog-typecheck '(* 5 2 1)) 10)
	      (printf "failed: (run-prog-typecheck '(* 5 2 1))\n"))
      (unless (equal? (run-prog-typecheck '(* 5 2 100 0)) 0)
	      (printf "failed: (run-prog-typecheck '(* 5 2 100 0))\n"))
      (unless (equal? (run-prog-typecheck '(/ 5)) 1/5)
	      (printf "failed: (run-prog-typecheck '(/ 5))\n"))
      (unless (equal? (run-prog-typecheck '(/ 10 5)) 2)
	      (printf "failed: (run-prog-typecheck '(/ 10 5))\n"))
      (unless (equal? (run-prog-typecheck '(/ 1000 20 5)) 10)
	      (printf "failed: (run-prog-typecheck '(/ 1000 20 5))\n"))
      ;;; Testing for scheme list primitives
      (unless (equal? (run-prog-typecheck '(car (cons 1 2))) 1)
	      (printf "failed: (run-prog-typecheck '(car (cons 1 2)))\n"))
      (unless (equal? (run-prog-typecheck '(cdr (cons 1 2))) '2)
	      (printf "failed: (run-prog-typecheck '(cdr (cons 1 2)))\n"))
      (unless (equal? (run-prog-typecheck '(car '(1 2))) 1)
	      (printf "failed: (run-prog-typecheck '(car '(1 2)))\n"))
      (unless (equal? (run-prog-typecheck '(cdr '(1 2))) '(2))
	      (printf "failed: (run-prog-typecheck '(cdr '(1 2)))\n"))
      (unless (equal? (run-prog-typecheck '(list 1 2 3)) '(1 2 3))
	      (printf "failed: (run-prog-typecheck '(list 1 2 3))\n"))
      (unless (equal? (run-prog-typecheck '(list (list 1 2 3))) '((1 2 3)))
	      (printf "failed: (run-prog-typecheck '(list (list 1 2 3)))\n"))
      ;;; Testing for call/cc
      (unless (equal? (run-prog-typecheck '(+ 5 (call/cc (lambda (k) 10)))) 15)
	      (printf "failed: (run-prog-typecheck '(+ 5 (call/cc (lambda (k) 10))))\n"))
      (unless (equal? (run-prog-typecheck '(+ 5 (call/cc (lambda (k) (k 10))))) 15)
	      (printf "failed: (run-prog-typecheck '(+ 5 (call/cc (lambda (k) (k 10)))))\n"))
      (unless (equal? (run-prog-typecheck '(+ 5 (call/cc (lambda (k) (/ (k 10) 0))))) 15)
	      (printf "failed: (run-prog-typecheck '(+ 5 (call/cc (lambda (k) (/ (k 10) 0)))))\n"))
      (unless (equal? (run-prog-typecheck '(/ 50 (call/cc (lambda (k) (+ 0 (k 25)))))) 2)
	      (printf "failed: (run-prog-typecheck '(/ 50 (call/cc (lambda (k) (+ 0 (k 25))))))\n"))
      ;;; Testing for simple cases of apply
      (unless (equal? (run-prog-typecheck '(apply + '(1 2 3))) 6)
	      (printf "failed: (run-prog-typecheck '(apply + '(1 2 3)))\n"))
      (unless (equal? (run-prog-typecheck '(apply (lambda (x) x) '(10))) 10)
	      (printf "failed: (run-prog-typecheck '(apply (lambda (x) x) '(10)))\n"))
      (unless (equal? (run-prog-typecheck '(apply * '(10 5 -1))) -50)
	      (printf "failed: (run-prog-typecheck '(apply * '(10 5 -1)))\n"))
      (unless (equal? (run-prog-typecheck '(apply (lambda () 1) '())) 1)
	      (printf "failed: (run-prog-typecheck '(apply (lambda () 1) '()))\n"))
      ;;; Testing for more complex cases of apply
      (unless (equal? (run-prog-typecheck '(apply apply (list + (list 5 3 1)))) 9)
	      (printf "failed: (run-prog-typecheck '(apply apply (list + (list 5 3 1))))\n"))
      (unless (equal? (run-prog-typecheck '(apply apply (list (lambda (a b) (+ a (+ b 1))) (list 10 20)))) 31)
	      (printf "failed: (run-prog-typecheck '(apply apply (list (lambda (a b) (+ a (+ b 1))) (list 10 20))))\n"))
      (unless (equal? (run-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) 10))))) 11)
	      (printf "failed: (run-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) 10)))))\n"))
      (unless (equal? (run-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) (k 10)))))) 11)
	      (printf "failed: (run-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) (k 10))))))\n"))
      (unless (equal? (run-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) (/ (k 10) 0)))))) 11)
	      (printf "failed: (run-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) (/ (k 10) 0))))))\n"))
      ;;; Testing for letrec expressions

      ;; Testing using factorial function
      (unless (equal? (run-prog-typecheck '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 5))) 120)
	      (printf "failed: (run-prog-typecheck '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 5)))\n"))
      (unless (equal? (run-prog-typecheck '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 7))) 5040)
	      (printf "failed: (run-prog-typecheck '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 7)))\n"))
      
      ;; Testing using ternary preternary postternary where result is expected to be #t
      (unless (equal? (run-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					  (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					  (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				   (ternary 12))) #t)
	      (printf "failed: (run-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(ternary 12)))\n"))
      (unless (equal? (run-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					  (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					  (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				   (preternary 5))) #t)
	      (printf "failed: (run-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(preternary 5)))\n"))
      (unless (equal? (run-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					  (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					  (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				   (postternary 31))) #t)
	      (printf "failed: (run-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(postternary 31)))\n"))
      
      ;; Testing using ternary preternary postternary where result is expected to be #f
      (unless (equal? (run-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					  (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					  (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				   (ternary 10))) #f)
	      (printf "failed: (run-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(ternary 10)))\n"))
      (unless (equal? (run-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					  (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					  (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				   (preternary 21))) #f)
	      (printf "failed: (run-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(preternary 21)))\n"))
      (unless (equal? (run-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					  (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					  (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				   (postternary 20))) #f)
	      (printf "failed: (run-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(postternary 20)))\n"))
      
      ;; Testing using even odd where result is expected to be #t
      (unless (equal? (run-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					  (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				   (even 10))) #t)
	      (printf "failed: (run-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(even 10)))\n"))
      (unless (equal? (run-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					  (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				   (odd 7))) #t)
	      (printf "failed: (run-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(odd 7)))\n"))

      ;; Testing using even odd where result is expected to be #f
      (unless (equal? (run-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					  (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				   (even 9))) #f)
	      (printf "failed: (run-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(even 9)))\n"))
      (unless (equal? (run-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					  (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				   (odd 6))) #f)
	      (printf "failed: (run-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(odd 6)))\n"))
    )))

;;; "verbose" version that prints out messages if test is fine. Hence, no error messages means that tests are NOT fine
(define test-verbose-run-prog-typecheck
  (lambda ()
    (begin
      ;;; Testing for base values
      (when   (equal? (run-prog-typecheck 0) 0)
	      (printf "succeeded: (run-prog-typecheck 0)\n"))
      (when   (equal? (run-prog-typecheck '#f) #f)
	      (printf "succeeded: (run-prog-typecheck '#f)\n"))
      (when   (equal? (run-prog-typecheck '#\f) #\f)
	      (printf "succeeded: (run-prog-typecheck '#\f)\n"))
      (when   (equal? (run-prog-typecheck "scheme_capstone") "scheme_capstone")
	      (printf "succeeded: (run-prog-typecheck \"scheme_capstone\")\n"))
      (when   (equal? (run-prog-typecheck '()) '())
	      (printf "succeeded: (run-prog-typecheck '())\n"))
      ;;; Testing for if expressions
      (when   (equal? (run-prog-typecheck '(if #t 1 2)) 1)
	      (printf "succeeded: (run-prog-typecheck '(if #t 1 2))\n"))
      (when   (equal? (run-prog-typecheck '(if #f 1 2)) 2)
	      (printf "succeeded: (run-prog-typecheck '(if #f 1 2))\n"))
      (when   (equal? (run-prog-typecheck '(if 0 1 2)) 1)
	      (printf "succeeded: (run-prog-typecheck '(if 0 1 2))\n"))
      (when   (equal? (run-prog-typecheck '((lambda (x) x) 1)) 1)
	      (printf "succeeded: (run-prog-typecheck '((lambda (x) x) 1))\n"))
      ;;; Testing for lambda expressions
      (when   (equal? (run-prog-typecheck '((lambda (x y) x) 1 2)) 1)
	      (printf "succeeded: (run-prog-typecheck '((lambda (x y) x) 1 2))\n"))
      (when   (equal? (run-prog-typecheck '((lambda (x y) x) 1 2)) 1)
	      (printf "succeeded: (run-prog-typecheck ((lambda (x y) x) 1 2))\n"))
      (when   (equal? (run-prog-typecheck '((lambda (x y) y) 1 2)) 2)
	      (printf "succeeded: (run-prog-typecheck ((lambda (x y) y) 1 2))\n"))
      (when   (equal? (run-prog-typecheck '((lambda xs xs) 1 2)) '(1 2))
	      (printf "succeeded: (run-prog-typecheck '((lambda xs xs) 1 2))\n"))
      (when   (equal? (run-prog-typecheck '((lambda (x . xs) xs) 1 2 3)) '(2 3))
	      (printf "succeeded: (run-prog-typecheck '((lambda (x . xs) xs) 1 2 3))\n"))
      ;;; Testing for let expressions
      (when   (equal? (run-prog-typecheck '(let () 2)) 2)
	      (printf "succeeded: (run-prog-typecheck '(let () 2))\n"))
      (when   (equal? (run-prog-typecheck '(let ((x 1)) x)) 1)
	      (printf "succeeded: (run-prog-typecheck '(let ((x 1)) x))\n"))
      (when   (equal? (run-prog-typecheck '(let ((x 1) (y 2)) x)) 1)
	      (printf "succeeded: (run-prog-typecheck '(let ((x 1) (y 2)) x))\n"))
      (when   (equal? (run-prog-typecheck '(let ((x 1) (y 2)) y)) 2)
	      (printf "succeeded: (run-prog-typecheck '(let ((x 1) (y 2)) y))\n"))
      ;;; Testing for quote expressions and nested quote expressions
      (when   (equal? (run-prog-typecheck ''(if #t 1 2)) '(if #t 1 2))
	      (printf "succeeded: (run-prog-typecheck ''(if #t 1 2))\n"))
      (when   (equal? (run-prog-typecheck ''((lambda (x y) x) 1 2))'((lambda (x y) x) 1 2))
	      (printf "succeeded: (run-prog-typecheck ''((lambda (x y) x) 1 2))\n"))
      (when   (equal? (run-prog-typecheck '''(if #t 1 2)) ''(if #t 1 2))
	      (printf "succeeded: (run-prog-typecheck '''(if #t 1 2))\n"))
      (when   (equal? (run-prog-typecheck '''((lambda (x y) x) 1 2))''((lambda (x y) x) 1 2))
	      (printf "succeeded: (run-prog-typecheck '''((lambda (x y) x) 1 2))\n"))
      ;;; Testing for cond expression
      (when   (equal? (run-prog-typecheck '(cond (#t 3)(#f 4)(else 1))) 3)
	      (printf "succeeded: (run-prog-typecheck '(cond (#t 3)(#f 4)(else 1)))\n"))
      (when   (equal? (run-prog-typecheck '(cond (#f 3)((equal? 5 5) 4)(else 1))) 4)
	      (printf "succeeded: (run-prog-typecheck '(cond (#f 3)((equal? 5 5) 4)(else 1)))\n"))
      (when   (equal? (run-prog-typecheck '(cond (#t 3)((equal? 5 5) 4)(else 1))) 3)
	      (printf "succeeded: (run-prog-typecheck '(cond (#t 3)((equal? 5 5) 4)(else 1)))\n"))
      (when   (equal? (run-prog-typecheck '(cond (#f 3)((equal? 5 5) (- 5 3 1))(else 9))) 1)
	      (printf "succeeded: (run-prog-typecheck '(cond (#f 3)((equal? 5 5) (- 5 3 1))(else 9)))\n"))
      (when   (equal? (run-prog-typecheck '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else (* 10 9)))) 90)
	      (printf "succeeded: (run-prog-typecheck '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else (* 10 9))))\n"))
      (when   (equal? (run-prog-typecheck '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else 9))) 9)
	      (printf "succeeded: (run-prog-typecheck '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else 9)))\n"))
      (when   (equal? (run-prog-typecheck '(cond (else 2))) '2)
	      (printf "succeeded: (run-prog-typecheck '(cond (else 2)))\n"))
      ;;; Testing for mathematical operator primitives
      (when   (equal? (run-prog-typecheck '(+)) 0)
	      (printf "succeeded: (run-prog-typecheck '(+))\n"))
      (when   (equal? (run-prog-typecheck '(+ 1)) 1)
	      (printf "succeeded: (run-prog-typecheck '(+ 1))\n"))
      (when   (equal? (run-prog-typecheck '(+ 1 10)) 11)
	      (printf "succeeded: (run-prog-typecheck '(+ 1 10))\n"))
      (when   (equal? (run-prog-typecheck '(+ 1 10 100)) 111)
	      (printf "succeeded: (run-prog-typecheck '(+ 1 10 100))\n"))
      (when   (equal? (run-prog-typecheck '(- 5)) -5)
	      (printf "succeeded: (run-prog-typecheck '(- 5))\n"))
      (when   (equal? (run-prog-typecheck '(- 5 1 2)) 2)
	      (printf "succeeded: (run-prog-typecheck '(- 5 1 2))\n"))
      (when   (equal? (run-prog-typecheck '(*)) 1)
	      (printf "succeeded: (run-prog-typecheck '(*))\n"))
      (when   (equal? (run-prog-typecheck '(* 5)) 5)
	      (printf "succeeded: (run-prog-typecheck '(* 5))\n"))
      (when   (equal? (run-prog-typecheck '(* 5 2 1)) 10)
	      (printf "succeeded: (run-prog-typecheck '(* 5 2 1))\n"))
      (when   (equal? (run-prog-typecheck '(* 5 2 100 0)) 0)
	      (printf "succeeded: (run-prog-typecheck '(* 5 2 100 0))\n"))
      (when   (equal? (run-prog-typecheck '(/ 5)) 1/5)
	      (printf "succeeded: (run-prog-typecheck '(/ 5))\n"))
      (when   (equal? (run-prog-typecheck '(/ 10 5)) 2)
	      (printf "succeeded: (run-prog-typecheck '(/ 10 5))\n"))
      (when   (equal? (run-prog-typecheck '(/ 1000 20 5)) 10)
	      (printf "succeeded: (run-prog-typecheck '(/ 1000 20 5))\n"))
      ;;; Testing for scheme list primitives
      (when   (equal? (run-prog-typecheck '(car (cons 1 2))) 1)
	      (printf "succeeded: (run-prog-typecheck '(car (cons 1 2)))\n"))
      (when   (equal? (run-prog-typecheck '(cdr (cons 1 2))) '2)
	      (printf "succeeded: (run-prog-typecheck '(cdr (cons 1 2)))\n"))
      (when   (equal? (run-prog-typecheck '(car '(1 2))) 1)
	      (printf "succeeded: (run-prog-typecheck '(car '(1 2)))\n"))
      (when   (equal? (run-prog-typecheck '(cdr '(1 2))) '(2))
	      (printf "succeeded: (run-prog-typecheck '(cdr '(1 2)))\n"))
      (when   (equal? (run-prog-typecheck '(list 1 2 3)) '(1 2 3))
	      (printf "succeeded: (run-prog-typecheck '(list 1 2 3))\n"))
      (when   (equal? (run-prog-typecheck '(list (list 1 2 3))) '((1 2 3)))
	      (printf "succeeded: (run-prog-typecheck '(list (list 1 2 3)))\n"))
      ;;; Testing for call/cc
      (when   (equal? (run-prog-typecheck '(+ 5 (call/cc (lambda (k) 10)))) 15)
	      (printf "succeeded: (run-prog-typecheck '(+ 5 (call/cc (lambda (k) 10))))\n"))
      (when   (equal? (run-prog-typecheck '(+ 5 (call/cc (lambda (k) (k 10))))) 15)
	      (printf "succeeded: (run-prog-typecheck '(+ 5 (call/cc (lambda (k) (k 10)))))\n"))
      (when   (equal? (run-prog-typecheck '(+ 5 (call/cc (lambda (k) (/ (k 10) 0))))) 15)
	      (printf "succeeded: (run-prog-typecheck '(+ 5 (call/cc (lambda (k) (/ (k 10) 0)))))\n"))
      (when   (equal? (run-prog-typecheck '(/ 50 (call/cc (lambda (k) (+ 0 (k 25)))))) 2)
	      (printf "succeeded: (run-prog-typecheck '(/ 50 (call/cc (lambda (k) (+ 0 (k 25))))))\n"))
      ;;; Testing for simple cases of apply
      (when   (equal? (run-prog-typecheck '(apply + '(1 2 3))) 6)
	      (printf "succeeded: (run-prog-typecheck '(apply + '(1 2 3)))\n"))
      (when   (equal? (run-prog-typecheck '(apply (lambda (x) x) '(10))) 10)
	      (printf "succeeded: (run-prog-typecheck '(apply (lambda (x) x) '(10)))\n"))
      (when   (equal? (run-prog-typecheck '(apply * '(10 5 -1))) -50)
	      (printf "succeeded: (run-prog-typecheck '(apply * '(10 5 -1)))\n"))
      (when   (equal? (run-prog-typecheck '(apply (lambda () 1) '())) 1)
	      (printf "succeeded: (run-prog-typecheck '(apply (lambda () 1) '()))\n"))
      ;;; Testing for more complex cases of apply
      (when   (equal? (run-prog-typecheck '(apply apply (list + (list 5 3 1)))) 9)
	      (printf "succeeded: (run-prog-typecheck '(apply apply (list + (list 5 3 1))))\n"))
      (when   (equal? (run-prog-typecheck '(apply apply (list (lambda (a b) (+ a (+ b 1))) (list 10 20)))) 31)
	      (printf "succeeded: (run-prog-typecheck '(apply apply (list (lambda (a b) (+ a (+ b 1))) (list 10 20))))\n"))
      (when   (equal? (run-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) 10))))) 11)
	      (printf "succeeded: (run-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) 10)))))\n"))
      (when   (equal? (run-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) (k 10)))))) 11)
	      (printf "succeeded: (run-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) (k 10))))))\n"))
      (when   (equal? (run-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) (/ (k 10) 0)))))) 11)
	      (printf "succeeded: (run-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) (/ (k 10) 0))))))\n"))
      ;;; Testing for letrec expressions

      ;; Testing using factorial function
      (when   (equal? (run-prog-typecheck '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 5))) 120)
	      (printf "succeeded: (run-prog-typecheck '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 5)))\n"))
      (when   (equal? (run-prog-typecheck '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 7))) 5040)
	      (printf "succeeded: (run-prog-typecheck '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 7)))\n"))
      
      ;; Testing using ternary preternary postternary where result is expected to be #t
      (when   (equal? (run-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					  (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					  (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				   (ternary 12))) #t)
	      (printf "succeeded: (run-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(ternary 12)))\n"))
      (when   (equal? (run-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					  (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					  (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				   (preternary 5))) #t)
	      (printf "succeeded: (run-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(preternary 5)))\n"))
      (when   (equal? (run-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					  (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					  (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				   (postternary 31))) #t)
	      (printf "succeeded: (run-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(postternary 31)))\n"))
      
      ;; Testing using ternary preternary postternary where result is expected to be #f
      (when   (equal? (run-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					  (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					  (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				   (ternary 10))) #f)
	      (printf "succeeded: (run-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(ternary 10)))\n"))
      (when   (equal? (run-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					  (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					  (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				   (preternary 21))) #f)
	      (printf "succeeded: (run-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(preternary 21)))\n"))
      (when   (equal? (run-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					  (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					  (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				   (postternary 20))) #f)
	      (printf "succeeded: (run-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(postternary 20)))\n"))

      ;; Testing using even odd where result is expected to be #t
      (when   (equal? (run-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					  (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				   (even 10))) #t)
	      (printf "succeeded: (run-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(even 10)))\n"))
      (when   (equal? (run-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					  (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				   (odd 7))) #t)
	      (printf "succeeded: (run-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(odd 7)))\n"))

      ;; Testing using even odd where result is expected to be #f
      (when (equal? (run-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					(odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				 (even 9))) #f)
	    (printf "succeeded: (run-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(even 9)))\n"))
      (when (equal? (run-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					(odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				 (odd 6))) #f)
	    (printf "succeeded: (run-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(odd 6)))\n"))
      )))


;;; Defining tests for run-2-prog-typecheck

;;; normal version
(define test-run-2-prog-typecheck
  (lambda ()
    (begin
      ;;; Testing for base values
      (unless (equal? (run-2-prog-typecheck 0) 0)
	      (printf "failed: (run-2-prog-typecheck 0)\n"))
      (unless (equal? (run-2-prog-typecheck '#f) #f)
	      (printf "failed: (run-2-prog-typecheck '#f)\n"))
      (unless (equal? (run-2-prog-typecheck '#\f) #\f)
	      (printf "failed: (run-2-prog-typecheck '#\f)\n"))
      (unless (equal? (run-2-prog-typecheck "scheme_capstone") "scheme_capstone")
	      (printf "failed: (run-2-prog-typecheck \"scheme_capstone\")\n"))
      (unless (equal? (run-2-prog-typecheck '()) '())
	      (printf "failed: (run-2-prog-typecheck '())\n"))
      ;;; Testing for if expressions
      (unless (equal? (run-2-prog-typecheck '(if #t 1 2)) 1)
	      (printf "failed: (run-2-prog-typecheck '(if #t 1 2))\n"))
      (unless (equal? (run-2-prog-typecheck '(if #f 1 2)) 2)
	      (printf "failed: (run-2-prog-typecheck '(if #f 1 2))\n"))
      (unless (equal? (run-2-prog-typecheck '(if 0 1 2)) 1)
	      (printf "failed: (run-2-prog-typecheck '(if 0 1 2))\n"))
      (unless (equal? (run-2-prog-typecheck '((lambda (x) x) 1)) 1)
	      (printf "failed: (run-2-prog-typecheck '((lambda (x) x) 1))\n"))
      ;;; Testing for lambda expressions
      (unless (equal? (run-2-prog-typecheck '((lambda (x y) x) 1 2)) 1)
	      (printf "failed: (run-2-prog-typecheck '((lambda (x y) x) 1 2))\n"))
      (unless (equal? (run-2-prog-typecheck '((lambda (x y) x) 1 2)) 1)
	      (printf "failed: (run-2-prog-typecheck ((lambda (x y) x) 1 2))\n"))
      (unless (equal? (run-2-prog-typecheck '((lambda (x y) y) 1 2)) 2)
	      (printf "failed: (run-2-prog-typecheck ((lambda (x y) y) 1 2))\n"))
      (unless (equal? (run-2-prog-typecheck '((lambda xs xs) 1 2)) '(1 2))
	      (printf "failed: (run-2-prog-typecheck '((lambda xs xs) 1 2))\n"))
      (unless (equal? (run-2-prog-typecheck '((lambda (x . xs) xs) 1 2 3)) '(2 3))
	      (printf "failed: (run-2-prog-typecheck '((lambda (x . xs) xs) 1 2 3))\n"))
      ;;; Testing for let expressions
      (unless (equal? (run-2-prog-typecheck '(let () 2)) 2)
	      (printf "failed: (run-2-prog-typecheck '(let () 2))\n"))
      (unless (equal? (run-2-prog-typecheck '(let ((x 1)) x)) 1)
	      (printf "failed: (run-2-prog-typecheck '(let ((x 1)) x))\n"))
      (unless (equal? (run-2-prog-typecheck '(let ((x 1) (y 2)) x)) 1)
	      (printf "failed: (run-2-prog-typecheck '(let ((x 1) (y 2)) x))\n"))
      (unless (equal? (run-2-prog-typecheck '(let ((x 1) (y 2)) y)) 2)
	      (printf "failed: (run-2-prog-typecheck '(let ((x 1) (y 2)) y))\n"))
      ;;; Testing for quote expressions and nested quote expressions
      (unless (equal? (run-2-prog-typecheck ''(if #t 1 2)) '(if #t 1 2))
	      (printf "failed: (run-2-prog-typecheck ''(if #t 1 2))\n"))
      (unless (equal? (run-2-prog-typecheck ''((lambda (x y) x) 1 2))'((lambda (x y) x) 1 2))
	      (printf "failed: (run-2-prog-typecheck ''((lambda (x y) x) 1 2))\n"))
      (unless (equal? (run-2-prog-typecheck '''(if #t 1 2)) ''(if #t 1 2))
	      (printf "failed: (run-2-prog-typecheck '''(if #t 1 2))\n"))
      (unless (equal? (run-2-prog-typecheck '''((lambda (x y) x) 1 2))''((lambda (x y) x) 1 2))
	      (printf "failed: (run-2-prog-typecheck '''((lambda (x y) x) 1 2))\n"))
      ;;; Testing for cond expression
      (unless (equal? (run-2-prog-typecheck '(cond (#t 3)(#f 4)(else 1))) 3)
	      (printf "failed: (run-2-prog-typecheck '(cond (#t 3)(#f 4)(else 1)))\n"))
      (unless (equal? (run-2-prog-typecheck '(cond (#f 3)((equal? 5 5) 4)(else 1))) 4)
	      (printf "failed: (run-2-prog-typecheck '(cond (#f 3)((equal? 5 5) 4)(else 1)))\n"))
      (unless (equal? (run-2-prog-typecheck '(cond (#t 3)((equal? 5 5) 4)(else 1))) 3)
	      (printf "failed: (run-2-prog-typecheck '(cond (#t 3)((equal? 5 5) 4)(else 1)))\n"))
      (unless (equal? (run-2-prog-typecheck '(cond (#f 3)((equal? 5 5) (- 5 3 1))(else 9))) 1)
	      (printf "failed: (run-2-prog-typecheck '(cond (#f 3)((equal? 5 5) (- 5 3 1))(else 9)))\n"))
      (unless (equal? (run-2-prog-typecheck '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else (* 10 9)))) 90)
	      (printf "failed: (run-2-prog-typecheck '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else (* 10 9))))\n"))
      (unless (equal? (run-2-prog-typecheck '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else 9))) 9)
	      (printf "failed: (run-2-prog-typecheck '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else 9)))\n"))
      (unless (equal? (run-2-prog-typecheck '(cond (else 2))) '2)
	      (printf "failed: (run-2-prog-typecheck '(cond (else 2)))\n"))
      ;;; Testing for mathematical operator primitives
      (unless (equal? (run-2-prog-typecheck '(+)) 0)
	      (printf "failed: (run-2-prog-typecheck '(+))\n"))
      (unless (equal? (run-2-prog-typecheck '(+ 1)) 1)
	      (printf "failed: (run-2-prog-typecheck '(+ 1))\n"))
      (unless (equal? (run-2-prog-typecheck '(+ 1 10)) 11)
	      (printf "failed: (run-2-prog-typecheck '(+ 1 10))\n"))
      (unless (equal? (run-2-prog-typecheck '(+ 1 10 100)) 111)
	      (printf "failed: (run-2-prog-typecheck '(+ 1 10 100))\n"))
      (unless (equal? (run-2-prog-typecheck '(- 5)) -5)
	      (printf "failed: (run-2-prog-typecheck '(- 5))\n"))
      (unless (equal? (run-2-prog-typecheck '(- 5 1 2)) 2)
	      (printf "failed: (run-2-prog-typecheck '(- 5 1 2))\n"))
      (unless (equal? (run-2-prog-typecheck '(*)) 1)
	      (printf "failed: (run-2-prog-typecheck '(*))\n"))
      (unless (equal? (run-2-prog-typecheck '(* 5)) 5)
	      (printf "failed: (run-2-prog-typecheck '(* 5))\n"))
      (unless (equal? (run-2-prog-typecheck '(* 5 2 1)) 10)
	      (printf "failed: (run-2-prog-typecheck '(* 5 2 1))\n"))
      (unless (equal? (run-2-prog-typecheck '(* 5 2 100 0)) 0)
	      (printf "failed: (run-2-prog-typecheck '(* 5 2 100 0))\n"))
      (unless (equal? (run-2-prog-typecheck '(/ 5)) 1/5)
	      (printf "failed: (run-2-prog-typecheck '(/ 5))\n"))
      (unless (equal? (run-2-prog-typecheck '(/ 10 5)) 2)
	      (printf "failed: (run-2-prog-typecheck '(/ 10 5))\n"))
      (unless (equal? (run-2-prog-typecheck '(/ 1000 20 5)) 10)
	      (printf "failed: (run-2-prog-typecheck '(/ 1000 20 5))\n"))
      ;;; Testing for scheme list primitives
      (unless (equal? (run-2-prog-typecheck '(car (cons 1 2))) 1)
	      (printf "failed: (run-2-prog-typecheck '(car (cons 1 2)))\n"))
      (unless (equal? (run-2-prog-typecheck '(cdr (cons 1 2))) '2)
	      (printf "failed: (run-2-prog-typecheck '(cdr (cons 1 2)))\n"))
      (unless (equal? (run-2-prog-typecheck '(car '(1 2))) 1)
	      (printf "failed: (run-2-prog-typecheck '(car '(1 2)))\n"))
      (unless (equal? (run-2-prog-typecheck '(cdr '(1 2))) '(2))
	      (printf "failed: (run-2-prog-typecheck '(cdr '(1 2)))\n"))
      (unless (equal? (run-2-prog-typecheck '(list 1 2 3)) '(1 2 3))
	      (printf "failed: (run-2-prog-typecheck '(list 1 2 3))\n"))
      (unless (equal? (run-2-prog-typecheck '(list (list 1 2 3))) '((1 2 3)))
	      (printf "failed: (run-2-prog-typecheck '(list (list 1 2 3)))\n"))
      ;;; Testing for call/cc
      (unless (equal? (run-2-prog-typecheck '(+ 5 (call/cc (lambda (k) 10)))) 15)
	      (printf "failed: (run-2-prog-typecheck '(+ 5 (call/cc (lambda (k) 10))))\n"))
      (unless (equal? (run-2-prog-typecheck '(+ 5 (call/cc (lambda (k) (k 10))))) 15)
	      (printf "failed: (run-2-prog-typecheck '(+ 5 (call/cc (lambda (k) (k 10)))))\n"))
      (unless (equal? (run-2-prog-typecheck '(+ 5 (call/cc (lambda (k) (/ (k 10) 0))))) 15)
	      (printf "failed: (run-2-prog-typecheck '(+ 5 (call/cc (lambda (k) (/ (k 10) 0)))))\n"))
      (unless (equal? (run-2-prog-typecheck '(/ 50 (call/cc (lambda (k) (+ 0 (k 25)))))) 2)
	      (printf "failed: (run-2-prog-typecheck '(/ 50 (call/cc (lambda (k) (+ 0 (k 25))))))\n"))
      ;;; Testing for simple cases of apply
      (unless (equal? (run-2-prog-typecheck '(apply + '(1 2 3))) 6)
	      (printf "failed: (run-2-prog-typecheck '(apply + '(1 2 3)))\n"))
      (unless (equal? (run-2-prog-typecheck '(apply (lambda (x) x) '(10))) 10)
	      (printf "failed: (run-2-prog-typecheck '(apply (lambda (x) x) '(10)))\n"))
      (unless (equal? (run-2-prog-typecheck '(apply * '(10 5 -1))) -50)
	      (printf "failed: (run-2-prog-typecheck '(apply * '(10 5 -1)))\n"))
      (unless (equal? (run-2-prog-typecheck '(apply (lambda () 1) '())) 1)
	      (printf "failed: (run-2-prog-typecheck '(apply (lambda () 1) '()))\n"))
      ;;; Testing for more complex cases of apply
      (unless (equal? (run-2-prog-typecheck '(apply apply (list + (list 5 3 1)))) 9)
	      (printf "failed: (run-2-prog-typecheck '(apply apply (list + (list 5 3 1))))\n"))
      (unless (equal? (run-2-prog-typecheck '(apply apply (list (lambda (a b) (+ a (+ b 1))) (list 10 20)))) 31)
	      (printf "failed: (run-2-prog-typecheck '(apply apply (list (lambda (a b) (+ a (+ b 1))) (list 10 20))))\n"))
      (unless (equal? (run-2-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) 10))))) 11)
	      (printf "failed: (run-2-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) 10)))))\n"))
      (unless (equal? (run-2-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) (k 10)))))) 11)
	      (printf "failed: (run-2-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) (k 10))))))\n"))
      (unless (equal? (run-2-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) (/ (k 10) 0)))))) 11)
	      (printf "failed: (run-2-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) (/ (k 10) 0))))))\n"))
      ;;; Testing for letrec expressions

      ;; Testing using factorial function
      (unless (equal? (run-2-prog-typecheck '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 5))) 120)
	      (printf "failed: (run-2-prog-typecheck '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 5)))\n"))
      (unless (equal? (run-2-prog-typecheck '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 7))) 5040)
	      (printf "failed: (run-2-prog-typecheck '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 7)))\n"))
      
      ;; Testing using ternary preternary postternary where result is expected to be #t
      (unless (equal? (run-2-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (ternary 12))) #t)
	      (printf "failed: (run-2-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(ternary 12)))\n"))
      (unless (equal? (run-2-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (preternary 5))) #t)
	      (printf "failed: (run-2-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(preternary 5)))\n"))
      (unless (equal? (run-2-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (postternary 31))) #t)
	      (printf "failed: (run-2-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(postternary 31)))\n"))
      
      ;; Testing using ternary preternary postternary where result is expected to be #f
      (unless (equal? (run-2-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (ternary 10))) #f)
	      (printf "failed: (run-2-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(ternary 10)))\n"))
      (unless (equal? (run-2-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (preternary 21))) #f)
	      (printf "failed: (run-2-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(preternary 21)))\n"))
      (unless (equal? (run-2-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (postternary 20))) #f)
	      (printf "failed: (run-2-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(postternary 20)))\n"))
      
      ;; Testing using even odd where result is expected to be #t
      (unless (equal? (run-2-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					    (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				     (even 10))) #t)
	      (printf "failed: (run-2-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(even 10)))\n"))
      (unless (equal? (run-2-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					    (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				     (odd 7))) #t)
	      (printf "failed: (run-2-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(odd 7)))\n"))

      ;; Testing using even odd where result is expected to be #f
      (unless (equal? (run-2-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					    (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				     (even 9))) #f)
	      (printf "failed: (run-2-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(even 9)))\n"))
      (unless (equal? (run-2-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					    (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				     (odd 6))) #f)
	      (printf "failed: (run-2-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(odd 6)))\n"))
      )))

;;; "verbose" version that prints out messages if test is fine. Hence, no error messages means that tests are NOT fine
(define test-verbose-run-2-prog-typecheck
  (lambda ()
    (begin
      ;;; Testing for base values
      (when   (equal? (run-2-prog-typecheck 0) 0)
	      (printf "succeeded: (run-2-prog-typecheck 0)\n"))
      (when   (equal? (run-2-prog-typecheck '#f) #f)
	      (printf "succeeded: (run-2-prog-typecheck '#f)\n"))
      (when   (equal? (run-2-prog-typecheck '#\f) #\f)
	      (printf "succeeded: (run-2-prog-typecheck '#\f)\n"))
      (when   (equal? (run-2-prog-typecheck "scheme_capstone") "scheme_capstone")
	      (printf "succeeded: (run-2-prog-typecheck \"scheme_capstone\")\n"))
      (when   (equal? (run-2-prog-typecheck '()) '())
	      (printf "succeeded: (run-2-prog-typecheck '())\n"))
      ;;; Testing for if expressions
      (when   (equal? (run-2-prog-typecheck '(if #t 1 2)) 1)
	      (printf "succeeded: (run-2-prog-typecheck '(if #t 1 2))\n"))
      (when   (equal? (run-2-prog-typecheck '(if #f 1 2)) 2)
	      (printf "succeeded: (run-2-prog-typecheck '(if #f 1 2))\n"))
      (when   (equal? (run-2-prog-typecheck '(if 0 1 2)) 1)
	      (printf "succeeded: (run-2-prog-typecheck '(if 0 1 2))\n"))
      (when   (equal? (run-2-prog-typecheck '((lambda (x) x) 1)) 1)
	      (printf "succeeded: (run-2-prog-typecheck '((lambda (x) x) 1))\n"))
      ;;; Testing for lambda expressions
      (when   (equal? (run-2-prog-typecheck '((lambda (x y) x) 1 2)) 1)
	      (printf "succeeded: (run-2-prog-typecheck '((lambda (x y) x) 1 2))\n"))
      (when   (equal? (run-2-prog-typecheck '((lambda (x y) x) 1 2)) 1)
	      (printf "succeeded: (run-2-prog-typecheck ((lambda (x y) x) 1 2))\n"))
      (when   (equal? (run-2-prog-typecheck '((lambda (x y) y) 1 2)) 2)
	      (printf "succeeded: (run-2-prog-typecheck ((lambda (x y) y) 1 2))\n"))
      (when   (equal? (run-2-prog-typecheck '((lambda xs xs) 1 2)) '(1 2))
	      (printf "succeeded: (run-2-prog-typecheck '((lambda xs xs) 1 2))\n"))
      (when   (equal? (run-2-prog-typecheck '((lambda (x . xs) xs) 1 2 3)) '(2 3))
	      (printf "succeeded: (run-2-prog-typecheck '((lambda (x . xs) xs) 1 2 3))\n"))
      ;;; Testing for let expressions
      (when   (equal? (run-2-prog-typecheck '(let () 2)) 2)
	      (printf "succeeded: (run-2-prog-typecheck '(let () 2))\n"))
      (when   (equal? (run-2-prog-typecheck '(let ((x 1)) x)) 1)
	      (printf "succeeded: (run-2-prog-typecheck '(let ((x 1)) x))\n"))
      (when   (equal? (run-2-prog-typecheck '(let ((x 1) (y 2)) x)) 1)
	      (printf "succeeded: (run-2-prog-typecheck '(let ((x 1) (y 2)) x))\n"))
      (when   (equal? (run-2-prog-typecheck '(let ((x 1) (y 2)) y)) 2)
	      (printf "succeeded: (run-2-prog-typecheck '(let ((x 1) (y 2)) y))\n"))
      ;;; Testing for quote expressions and nested quote expressions
      (when   (equal? (run-2-prog-typecheck ''(if #t 1 2)) '(if #t 1 2))
	      (printf "succeeded: (run-2-prog-typecheck ''(if #t 1 2))\n"))
      (when   (equal? (run-2-prog-typecheck ''((lambda (x y) x) 1 2))'((lambda (x y) x) 1 2))
	      (printf "succeeded: (run-2-prog-typecheck ''((lambda (x y) x) 1 2))\n"))
      (when   (equal? (run-2-prog-typecheck '''(if #t 1 2)) ''(if #t 1 2))
	      (printf "succeeded: (run-2-prog-typecheck '''(if #t 1 2))\n"))
      (when   (equal? (run-2-prog-typecheck '''((lambda (x y) x) 1 2))''((lambda (x y) x) 1 2))
	      (printf "succeeded: (run-2-prog-typecheck '''((lambda (x y) x) 1 2))\n"))
      ;;; Testing for cond expression
      (when   (equal? (run-2-prog-typecheck '(cond (#t 3)(#f 4)(else 1))) 3)
	      (printf "succeeded: (run-2-prog-typecheck '(cond (#t 3)(#f 4)(else 1)))\n"))
      (when   (equal? (run-2-prog-typecheck '(cond (#f 3)((equal? 5 5) 4)(else 1))) 4)
	      (printf "succeeded: (run-2-prog-typecheck '(cond (#f 3)((equal? 5 5) 4)(else 1)))\n"))
      (when   (equal? (run-2-prog-typecheck '(cond (#t 3)((equal? 5 5) 4)(else 1))) 3)
	      (printf "succeeded: (run-2-prog-typecheck '(cond (#t 3)((equal? 5 5) 4)(else 1)))\n"))
      (when   (equal? (run-2-prog-typecheck '(cond (#f 3)((equal? 5 5) (- 5 3 1))(else 9))) 1)
	      (printf "succeeded: (run-2-prog-typecheck '(cond (#f 3)((equal? 5 5) (- 5 3 1))(else 9)))\n"))
      (when   (equal? (run-2-prog-typecheck '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else (* 10 9)))) 90)
	      (printf "succeeded: (run-2-prog-typecheck '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else (* 10 9))))\n"))
      (when   (equal? (run-2-prog-typecheck '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else 9))) 9)
	      (printf "succeeded: (run-2-prog-typecheck '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else 9)))\n"))
      (when   (equal? (run-2-prog-typecheck '(cond (else 2))) '2)
	      (printf "succeeded: (run-2-prog-typecheck '(cond (else 2)))\n"))
      ;;; Testing for mathematical operator primitives
      (when   (equal? (run-2-prog-typecheck '(+)) 0)
	      (printf "succeeded: (run-2-prog-typecheck '(+))\n"))
      (when   (equal? (run-2-prog-typecheck '(+ 1)) 1)
	      (printf "succeeded: (run-2-prog-typecheck '(+ 1))\n"))
      (when   (equal? (run-2-prog-typecheck '(+ 1 10)) 11)
	      (printf "succeeded: (run-2-prog-typecheck '(+ 1 10))\n"))
      (when   (equal? (run-2-prog-typecheck '(+ 1 10 100)) 111)
	      (printf "succeeded: (run-2-prog-typecheck '(+ 1 10 100))\n"))
      (when   (equal? (run-2-prog-typecheck '(- 5)) -5)
	      (printf "succeeded: (run-2-prog-typecheck '(- 5))\n"))
      (when   (equal? (run-2-prog-typecheck '(- 5 1 2)) 2)
	      (printf "succeeded: (run-2-prog-typecheck '(- 5 1 2))\n"))
      (when   (equal? (run-2-prog-typecheck '(*)) 1)
	      (printf "succeeded: (run-2-prog-typecheck '(*))\n"))
      (when   (equal? (run-2-prog-typecheck '(* 5)) 5)
	      (printf "succeeded: (run-2-prog-typecheck '(* 5))\n"))
      (when   (equal? (run-2-prog-typecheck '(* 5 2 1)) 10)
	      (printf "succeeded: (run-2-prog-typecheck '(* 5 2 1))\n"))
      (when   (equal? (run-2-prog-typecheck '(* 5 2 100 0)) 0)
	      (printf "succeeded: (run-2-prog-typecheck '(* 5 2 100 0))\n"))
      (when   (equal? (run-2-prog-typecheck '(/ 5)) 1/5)
	      (printf "succeeded: (run-2-prog-typecheck '(/ 5))\n"))
      (when   (equal? (run-2-prog-typecheck '(/ 10 5)) 2)
	      (printf "succeeded: (run-2-prog-typecheck '(/ 10 5))\n"))
      (when   (equal? (run-2-prog-typecheck '(/ 1000 20 5)) 10)
	      (printf "succeeded: (run-2-prog-typecheck '(/ 1000 20 5))\n"))
      ;;; Testing for scheme list primitives
      (when   (equal? (run-2-prog-typecheck '(car (cons 1 2))) 1)
	      (printf "succeeded: (run-2-prog-typecheck '(car (cons 1 2)))\n"))
      (when   (equal? (run-2-prog-typecheck '(cdr (cons 1 2))) '2)
	      (printf "succeeded: (run-2-prog-typecheck '(cdr (cons 1 2)))\n"))
      (when   (equal? (run-2-prog-typecheck '(car '(1 2))) 1)
	      (printf "succeeded: (run-2-prog-typecheck '(car '(1 2)))\n"))
      (when   (equal? (run-2-prog-typecheck '(cdr '(1 2))) '(2))
	      (printf "succeeded: (run-2-prog-typecheck '(cdr '(1 2)))\n"))
      (when   (equal? (run-2-prog-typecheck '(list 1 2 3)) '(1 2 3))
	      (printf "succeeded: (run-2-prog-typecheck '(list 1 2 3))\n"))
      (when   (equal? (run-2-prog-typecheck '(list (list 1 2 3))) '((1 2 3)))
	      (printf "succeeded: (run-2-prog-typecheck '(list (list 1 2 3)))\n"))
      ;;; Testing for call/cc
      (when   (equal? (run-2-prog-typecheck '(+ 5 (call/cc (lambda (k) 10)))) 15)
	      (printf "succeeded: (run-2-prog-typecheck '(+ 5 (call/cc (lambda (k) 10))))\n"))
      (when   (equal? (run-2-prog-typecheck '(+ 5 (call/cc (lambda (k) (k 10))))) 15)
	      (printf "succeeded: (run-2-prog-typecheck '(+ 5 (call/cc (lambda (k) (k 10)))))\n"))
      (when   (equal? (run-2-prog-typecheck '(+ 5 (call/cc (lambda (k) (/ (k 10) 0))))) 15)
	      (printf "succeeded: (run-2-prog-typecheck '(+ 5 (call/cc (lambda (k) (/ (k 10) 0)))))\n"))
      (when   (equal? (run-2-prog-typecheck '(/ 50 (call/cc (lambda (k) (+ 0 (k 25)))))) 2)
	      (printf "succeeded: (run-2-prog-typecheck '(/ 50 (call/cc (lambda (k) (+ 0 (k 25))))))\n"))
      ;;; Testing for simple cases of apply
      (when   (equal? (run-2-prog-typecheck '(apply + '(1 2 3))) 6)
	      (printf "succeeded: (run-2-prog-typecheck '(apply + '(1 2 3)))\n"))
      (when   (equal? (run-2-prog-typecheck '(apply (lambda (x) x) '(10))) 10)
	      (printf "succeeded: (run-2-prog-typecheck '(apply (lambda (x) x) '(10)))\n"))
      (when   (equal? (run-2-prog-typecheck '(apply * '(10 5 -1))) -50)
	      (printf "succeeded: (run-2-prog-typecheck '(apply * '(10 5 -1)))\n"))
      (when   (equal? (run-2-prog-typecheck '(apply (lambda () 1) '())) 1)
	      (printf "succeeded: (run-2-prog-typecheck '(apply (lambda () 1) '()))\n"))
      ;;; Testing for more complex cases of apply
      (when   (equal? (run-2-prog-typecheck '(apply apply (list + (list 5 3 1)))) 9)
	      (printf "succeeded: (run-2-prog-typecheck '(apply apply (list + (list 5 3 1))))\n"))
      (when   (equal? (run-2-prog-typecheck '(apply apply (list (lambda (a b) (+ a (+ b 1))) (list 10 20)))) 31)
	      (printf "succeeded: (run-2-prog-typecheck '(apply apply (list (lambda (a b) (+ a (+ b 1))) (list 10 20))))\n"))
      (when   (equal? (run-2-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) 10))))) 11)
	      (printf "succeeded: (run-2-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) 10)))))\n"))
      (when   (equal? (run-2-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) (k 10)))))) 11)
	      (printf "succeeded: (run-2-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) (k 10))))))\n"))
      (when   (equal? (run-2-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) (/ (k 10) 0)))))) 11)
	      (printf "succeeded: (run-2-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) (/ (k 10) 0))))))\n"))
      ;;; Testing for letrec expressions

      ;; Testing using factorial function
      (when   (equal? (run-2-prog-typecheck '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 5))) 120)
	      (printf "succeeded: (run-2-prog-typecheck '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 5)))\n"))
      (when   (equal? (run-2-prog-typecheck '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 7))) 5040)
	      (printf "succeeded: (run-2-prog-typecheck '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 7)))\n"))
      
      ;; Testing using ternary preternary postternary where result is expected to be #t
      (when   (equal? (run-2-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (ternary 12))) #t)
	      (printf "succeeded: (run-2-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(ternary 12)))\n"))
      (when   (equal? (run-2-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (preternary 5))) #t)
	      (printf "succeeded: (run-2-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(preternary 5)))\n"))
      (when   (equal? (run-2-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (postternary 31))) #t)
	      (printf "succeeded: (run-2-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(postternary 31)))\n"))
      
      ;; Testing using ternary preternary postternary where result is expected to be #f
      (when   (equal? (run-2-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (ternary 10))) #f)
	      (printf "succeeded: (run-2-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(ternary 10)))\n"))
      (when   (equal? (run-2-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (preternary 21))) #f)
	      (printf "succeeded: (run-2-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(preternary 21)))\n"))
      (when   (equal? (run-2-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (postternary 20))) #f)
	      (printf "succeeded: (run-2-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(postternary 20)))\n"))

      ;; Testing using even odd where result is expected to be #t
      (when   (equal? (run-2-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					    (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				     (even 10))) #t)
	      (printf "succeeded: (run-2-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(even 10)))\n"))
      (when   (equal? (run-2-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					    (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				     (odd 7))) #t)
	      (printf "succeeded: (run-2-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(odd 7)))\n"))

      ;; Testing using even odd where result is expected to be #f
      (when (equal? (run-2-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					  (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				   (even 9))) #f)
	    (printf "succeeded: (run-2-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(even 9)))\n"))
      (when (equal? (run-2-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					  (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				   (odd 6))) #f)
	    (printf "succeeded: (run-2-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(odd 6)))\n"))
      )))

;;; Defining tests for run-3-prog-typecheck

;;; normal version
(define test-run-3-prog-typecheck
  (lambda ()
    (begin
      ;;; Testing for base values
      (unless (equal? (run-3-prog-typecheck 0) 0)
	      (printf "failed: (run-3-prog-typecheck 0)\n"))
      (unless (equal? (run-3-prog-typecheck '#f) #f)
	      (printf "failed: (run-3-prog-typecheck '#f)\n"))
      (unless (equal? (run-3-prog-typecheck '#\f) #\f)
	      (printf "failed: (run-3-prog-typecheck '#\f)\n"))
      (unless (equal? (run-3-prog-typecheck "scheme_capstone") "scheme_capstone")
	      (printf "failed: (run-3-prog-typecheck \"scheme_capstone\")\n"))
      (unless (equal? (run-3-prog-typecheck '()) '())
	      (printf "failed: (run-3-prog-typecheck '())\n"))
      ;;; Testing for if expressions
      (unless (equal? (run-3-prog-typecheck '(if #t 1 2)) 1)
	      (printf "failed: (run-3-prog-typecheck '(if #t 1 2))\n"))
      (unless (equal? (run-3-prog-typecheck '(if #f 1 2)) 2)
	      (printf "failed: (run-3-prog-typecheck '(if #f 1 2))\n"))
      (unless (equal? (run-3-prog-typecheck '(if 0 1 2)) 1)
	      (printf "failed: (run-3-prog-typecheck '(if 0 1 2))\n"))
      (unless (equal? (run-3-prog-typecheck '((lambda (x) x) 1)) 1)
	      (printf "failed: (run-3-prog-typecheck '((lambda (x) x) 1))\n"))
      ;;; Testing for lambda expressions
      (unless (equal? (run-3-prog-typecheck '((lambda (x y) x) 1 2)) 1)
	      (printf "failed: (run-3-prog-typecheck '((lambda (x y) x) 1 2))\n"))
      (unless (equal? (run-3-prog-typecheck '((lambda (x y) x) 1 2)) 1)
	      (printf "failed: (run-3-prog-typecheck ((lambda (x y) x) 1 2))\n"))
      (unless (equal? (run-3-prog-typecheck '((lambda (x y) y) 1 2)) 2)
	      (printf "failed: (run-3-prog-typecheck ((lambda (x y) y) 1 2))\n"))
      (unless (equal? (run-3-prog-typecheck '((lambda xs xs) 1 2)) '(1 2))
	      (printf "failed: (run-3-prog-typecheck '((lambda xs xs) 1 2))\n"))
      (unless (equal? (run-3-prog-typecheck '((lambda (x . xs) xs) 1 2 3)) '(2 3))
	      (printf "failed: (run-3-prog-typecheck '((lambda (x . xs) xs) 1 2 3))\n"))
      ;;; Testing for let expressions
      (unless (equal? (run-3-prog-typecheck '(let () 2)) 2)
	      (printf "failed: (run-3-prog-typecheck '(let () 2))\n"))
      (unless (equal? (run-3-prog-typecheck '(let ((x 1)) x)) 1)
	      (printf "failed: (run-3-prog-typecheck '(let ((x 1)) x))\n"))
      (unless (equal? (run-3-prog-typecheck '(let ((x 1) (y 2)) x)) 1)
	      (printf "failed: (run-3-prog-typecheck '(let ((x 1) (y 2)) x))\n"))
      (unless (equal? (run-3-prog-typecheck '(let ((x 1) (y 2)) y)) 2)
	      (printf "failed: (run-3-prog-typecheck '(let ((x 1) (y 2)) y))\n"))
      ;;; Testing for quote expressions and nested quote expressions
      (unless (equal? (run-3-prog-typecheck ''(if #t 1 2)) '(if #t 1 2))
	      (printf "failed: (run-3-prog-typecheck ''(if #t 1 2))\n"))
      (unless (equal? (run-3-prog-typecheck ''((lambda (x y) x) 1 2))'((lambda (x y) x) 1 2))
	      (printf "failed: (run-3-prog-typecheck ''((lambda (x y) x) 1 2))\n"))
      (unless (equal? (run-3-prog-typecheck '''(if #t 1 2)) ''(if #t 1 2))
	      (printf "failed: (run-3-prog-typecheck '''(if #t 1 2))\n"))
      (unless (equal? (run-3-prog-typecheck '''((lambda (x y) x) 1 2))''((lambda (x y) x) 1 2))
	      (printf "failed: (run-3-prog-typecheck '''((lambda (x y) x) 1 2))\n"))
      ;;; Testing for cond expression
      (unless (equal? (run-3-prog-typecheck '(cond (#t 3)(#f 4)(else 1))) 3)
	      (printf "failed: (run-3-prog-typecheck '(cond (#t 3)(#f 4)(else 1)))\n"))
      (unless (equal? (run-3-prog-typecheck '(cond (#f 3)((equal? 5 5) 4)(else 1))) 4)
	      (printf "failed: (run-3-prog-typecheck '(cond (#f 3)((equal? 5 5) 4)(else 1)))\n"))
      (unless (equal? (run-3-prog-typecheck '(cond (#t 3)((equal? 5 5) 4)(else 1))) 3)
	      (printf "failed: (run-3-prog-typecheck '(cond (#t 3)((equal? 5 5) 4)(else 1)))\n"))
      (unless (equal? (run-3-prog-typecheck '(cond (#f 3)((equal? 5 5) (- 5 3 1))(else 9))) 1)
	      (printf "failed: (run-3-prog-typecheck '(cond (#f 3)((equal? 5 5) (- 5 3 1))(else 9)))\n"))
      (unless (equal? (run-3-prog-typecheck '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else (* 10 9)))) 90)
	      (printf "failed: (run-3-prog-typecheck '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else (* 10 9))))\n"))
      (unless (equal? (run-3-prog-typecheck '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else 9))) 9)
	      (printf "failed: (run-3-prog-typecheck '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else 9)))\n"))
      (unless (equal? (run-3-prog-typecheck '(cond (else 2))) '2)
	      (printf "failed: (run-3-prog-typecheck '(cond (else 2)))\n"))
      ;;; Testing for mathematical operator primitives
      (unless (equal? (run-3-prog-typecheck '(+)) 0)
	      (printf "failed: (run-3-prog-typecheck '(+))\n"))
      (unless (equal? (run-3-prog-typecheck '(+ 1)) 1)
	      (printf "failed: (run-3-prog-typecheck '(+ 1))\n"))
      (unless (equal? (run-3-prog-typecheck '(+ 1 10)) 11)
	      (printf "failed: (run-3-prog-typecheck '(+ 1 10))\n"))
      (unless (equal? (run-3-prog-typecheck '(+ 1 10 100)) 111)
	      (printf "failed: (run-3-prog-typecheck '(+ 1 10 100))\n"))
      (unless (equal? (run-3-prog-typecheck '(- 5)) -5)
	      (printf "failed: (run-3-prog-typecheck '(- 5))\n"))
      (unless (equal? (run-3-prog-typecheck '(- 5 1 2)) 2)
	      (printf "failed: (run-3-prog-typecheck '(- 5 1 2))\n"))
      (unless (equal? (run-3-prog-typecheck '(*)) 1)
	      (printf "failed: (run-3-prog-typecheck '(*))\n"))
      (unless (equal? (run-3-prog-typecheck '(* 5)) 5)
	      (printf "failed: (run-3-prog-typecheck '(* 5))\n"))
      (unless (equal? (run-3-prog-typecheck '(* 5 2 1)) 10)
	      (printf "failed: (run-3-prog-typecheck '(* 5 2 1))\n"))
      (unless (equal? (run-3-prog-typecheck '(* 5 2 100 0)) 0)
	      (printf "failed: (run-3-prog-typecheck '(* 5 2 100 0))\n"))
      (unless (equal? (run-3-prog-typecheck '(/ 5)) 1/5)
	      (printf "failed: (run-3-prog-typecheck '(/ 5))\n"))
      (unless (equal? (run-3-prog-typecheck '(/ 10 5)) 2)
	      (printf "failed: (run-3-prog-typecheck '(/ 10 5))\n"))
      (unless (equal? (run-3-prog-typecheck '(/ 1000 20 5)) 10)
	      (printf "failed: (run-3-prog-typecheck '(/ 1000 20 5))\n"))
      ;;; Testing for scheme list primitives
      (unless (equal? (run-3-prog-typecheck '(car (cons 1 2))) 1)
	      (printf "failed: (run-3-prog-typecheck '(car (cons 1 2)))\n"))
      (unless (equal? (run-3-prog-typecheck '(cdr (cons 1 2))) '2)
	      (printf "failed: (run-3-prog-typecheck '(cdr (cons 1 2)))\n"))
      (unless (equal? (run-3-prog-typecheck '(car '(1 2))) 1)
	      (printf "failed: (run-3-prog-typecheck '(car '(1 2)))\n"))
      (unless (equal? (run-3-prog-typecheck '(cdr '(1 2))) '(2))
	      (printf "failed: (run-3-prog-typecheck '(cdr '(1 2)))\n"))
      (unless (equal? (run-3-prog-typecheck '(list 1 2 3)) '(1 2 3))
	      (printf "failed: (run-3-prog-typecheck '(list 1 2 3))\n"))
      (unless (equal? (run-3-prog-typecheck '(list (list 1 2 3))) '((1 2 3)))
	      (printf "failed: (run-3-prog-typecheck '(list (list 1 2 3)))\n"))
      ;;; Testing for call/cc
      (unless (equal? (run-3-prog-typecheck '(+ 5 (call/cc (lambda (k) 10)))) 15)
	      (printf "failed: (run-3-prog-typecheck '(+ 5 (call/cc (lambda (k) 10))))\n"))
      (unless (equal? (run-3-prog-typecheck '(+ 5 (call/cc (lambda (k) (k 10))))) 15)
	      (printf "failed: (run-3-prog-typecheck '(+ 5 (call/cc (lambda (k) (k 10)))))\n"))
      (unless (equal? (run-3-prog-typecheck '(+ 5 (call/cc (lambda (k) (/ (k 10) 0))))) 15)
	      (printf "failed: (run-3-prog-typecheck '(+ 5 (call/cc (lambda (k) (/ (k 10) 0)))))\n"))
      (unless (equal? (run-3-prog-typecheck '(/ 50 (call/cc (lambda (k) (+ 0 (k 25)))))) 2)
	      (printf "failed: (run-3-prog-typecheck '(/ 50 (call/cc (lambda (k) (+ 0 (k 25))))))\n"))
      ;;; Testing for simple cases of apply
      (unless (equal? (run-3-prog-typecheck '(apply + '(1 2 3))) 6)
	      (printf "failed: (run-3-prog-typecheck '(apply + '(1 2 3)))\n"))
      (unless (equal? (run-3-prog-typecheck '(apply (lambda (x) x) '(10))) 10)
	      (printf "failed: (run-3-prog-typecheck '(apply (lambda (x) x) '(10)))\n"))
      (unless (equal? (run-3-prog-typecheck '(apply * '(10 5 -1))) -50)
	      (printf "failed: (run-3-prog-typecheck '(apply * '(10 5 -1)))\n"))
      (unless (equal? (run-3-prog-typecheck '(apply (lambda () 1) '())) 1)
	      (printf "failed: (run-3-prog-typecheck '(apply (lambda () 1) '()))\n"))
      ;;; Testing for more complex cases of apply
      (unless (equal? (run-3-prog-typecheck '(apply apply (list + (list 5 3 1)))) 9)
	      (printf "failed: (run-3-prog-typecheck '(apply apply (list + (list 5 3 1))))\n"))
      (unless (equal? (run-3-prog-typecheck '(apply apply (list (lambda (a b) (+ a (+ b 1))) (list 10 20)))) 31)
	      (printf "failed: (run-3-prog-typecheck '(apply apply (list (lambda (a b) (+ a (+ b 1))) (list 10 20))))\n"))
      (unless (equal? (run-3-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) 10))))) 11)
	      (printf "failed: (run-3-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) 10)))))\n"))
      (unless (equal? (run-3-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) (k 10)))))) 11)
	      (printf "failed: (run-3-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) (k 10))))))\n"))
      (unless (equal? (run-3-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) (/ (k 10) 0)))))) 11)
	      (printf "failed: (run-3-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) (/ (k 10) 0))))))\n"))
      ;;; Testing for letrec expressions

      ;; Testing using factorial function
      (unless (equal? (run-3-prog-typecheck '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 5))) 120)
	      (printf "failed: (run-3-prog-typecheck '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 5)))\n"))
      (unless (equal? (run-3-prog-typecheck '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 7))) 5040)
	      (printf "failed: (run-3-prog-typecheck '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 7)))\n"))
      
      ;; Testing using ternary preternary postternary where result is expected to be #t
      (unless (equal? (run-3-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (ternary 12))) #t)
	      (printf "failed: (run-3-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(ternary 12)))\n"))
      (unless (equal? (run-3-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (preternary 5))) #t)
	      (printf "failed: (run-3-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(preternary 5)))\n"))
      (unless (equal? (run-3-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (postternary 31))) #t)
	      (printf "failed: (run-3-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(postternary 31)))\n"))
      
      ;; Testing using ternary preternary postternary where result is expected to be #f
      (unless (equal? (run-3-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (ternary 10))) #f)
	      (printf "failed: (run-3-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(ternary 10)))\n"))
      (unless (equal? (run-3-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (preternary 21))) #f)
	      (printf "failed: (run-3-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(preternary 21)))\n"))
      (unless (equal? (run-3-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (postternary 20))) #f)
	      (printf "failed: (run-3-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(postternary 20)))\n"))
      
      ;; Testing using even odd where result is expected to be #t
      (unless (equal? (run-3-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					    (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				     (even 10))) #t)
	      (printf "failed: (run-3-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(even 10)))\n"))
      (unless (equal? (run-3-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					    (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				     (odd 7))) #t)
	      (printf "failed: (run-3-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(odd 7)))\n"))

      ;; Testing using even odd where result is expected to be #f
      (unless (equal? (run-3-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					    (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				     (even 9))) #f)
	      (printf "failed: (run-3-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(even 9)))\n"))
      (unless (equal? (run-3-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					    (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				     (odd 6))) #f)
	      (printf "failed: (run-3-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(odd 6)))\n"))
      )))

;;; "verbose" version that prints out messages if test is fine. Hence, no error messages means that tests are NOT fine
(define test-verbose-run-3-prog-typecheck
  (lambda ()
    (begin
      ;;; Testing for base values
      (when   (equal? (run-3-prog-typecheck 0) 0)
	      (printf "succeeded: (run-3-prog-typecheck 0)\n"))
      (when   (equal? (run-3-prog-typecheck '#f) #f)
	      (printf "succeeded: (run-3-prog-typecheck '#f)\n"))
      (when   (equal? (run-3-prog-typecheck '#\f) #\f)
	      (printf "succeeded: (run-3-prog-typecheck '#\f)\n"))
      (when   (equal? (run-3-prog-typecheck "scheme_capstone") "scheme_capstone")
	      (printf "succeeded: (run-3-prog-typecheck \"scheme_capstone\")\n"))
      (when   (equal? (run-3-prog-typecheck '()) '())
	      (printf "succeeded: (run-3-prog-typecheck '())\n"))
      ;;; Testing for if expressions
      (when   (equal? (run-3-prog-typecheck '(if #t 1 2)) 1)
	      (printf "succeeded: (run-3-prog-typecheck (if #t 1 2))\n"))
      (when   (equal? (run-3-prog-typecheck '(if #f 1 2)) 2)
	      (printf "succeeded: (run-3-prog-typecheck (if #f 1 2))\n"))
      (when   (equal? (run-3-prog-typecheck '(if 0 1 2)) 1)
	      (printf "succeeded: (run-3-prog-typecheck (if 0 1 2))\n"))
      (when   (equal? (run-3-prog-typecheck '((lambda (x) x) 1)) 1)
	      (printf "succeeded: (run-3-prog-typecheck '((lambda (x) x) 1))\n"))
      ;;; Testing for lambda expressions
      (when   (equal? (run-3-prog-typecheck '((lambda (x y) x) 1 2)) 1)
	      (printf "succeeded: (run-3-prog-typecheck '((lambda (x y) x) 1 2))\n"))
      (when   (equal? (run-3-prog-typecheck '((lambda (x y) x) 1 2)) 1)
	      (printf "succeeded: (run-3-prog-typecheck ((lambda (x y) x) 1 2))\n"))
      (when   (equal? (run-3-prog-typecheck '((lambda (x y) y) 1 2)) 2)
	      (printf "succeeded: (run-3-prog-typecheck ((lambda (x y) y) 1 2))\n"))
      (when   (equal? (run-3-prog-typecheck '((lambda xs xs) 1 2)) '(1 2))
	      (printf "succeeded: (run-3-prog-typecheck '((lambda xs xs) 1 2))\n"))
      (when   (equal? (run-3-prog-typecheck '((lambda (x . xs) xs) 1 2 3)) '(2 3))
	      (printf "succeeded: (run-3-prog-typecheck '((lambda (x . xs) xs) 1 2 3))\n"))
      ;;; Testing for let expressions
      (when   (equal? (run-3-prog-typecheck '(let () 2)) 2)
	      (printf "succeeded: (run-3-prog-typecheck '(let () 2))\n"))
      (when   (equal? (run-3-prog-typecheck '(let ((x 1)) x)) 1)
	      (printf "succeeded: (run-3-prog-typecheck '(let ((x 1)) x))\n"))
      (when   (equal? (run-3-prog-typecheck '(let ((x 1) (y 2)) x)) 1)
	      (printf "succeeded: (run-3-prog-typecheck '(let ((x 1) (y 2)) x))\n"))
      (when   (equal? (run-3-prog-typecheck '(let ((x 1) (y 2)) y)) 2)
	      (printf "succeeded: (run-3-prog-typecheck '(let ((x 1) (y 2)) y))\n"))
      ;;; Testing for quote expressions and nested quote expressions
      (when   (equal? (run-3-prog-typecheck ''(if #t 1 2)) '(if #t 1 2))
	      (printf "succeeded: (run-3-prog-typecheck ''(if #t 1 2))\n"))
      (when   (equal? (run-3-prog-typecheck ''((lambda (x y) x) 1 2))'((lambda (x y) x) 1 2))
	      (printf "succeeded: (run-3-prog-typecheck ''((lambda (x y) x) 1 2))\n"))
      (when   (equal? (run-3-prog-typecheck '''(if #t 1 2)) ''(if #t 1 2))
	      (printf "succeeded: (run-3-prog-typecheck '''(if #t 1 2))\n"))
      (when   (equal? (run-3-prog-typecheck '''((lambda (x y) x) 1 2))''((lambda (x y) x) 1 2))
	      (printf "succeeded: (run-3-prog-typecheck '''((lambda (x y) x) 1 2))\n"))
      ;;; Testing for cond expression
      (when   (equal? (run-3-prog-typecheck '(cond (#t 3)(#f 4)(else 1))) 3)
	      (printf "succeeded: (run-3-prog-typecheck '(cond (#t 3)(#f 4)(else 1)))\n"))
      (when   (equal? (run-3-prog-typecheck '(cond (#f 3)((equal? 5 5) 4)(else 1))) 4)
	      (printf "succeeded: (run-3-prog-typecheck '(cond (#f 3)((equal? 5 5) 4)(else 1)))\n"))
      (when   (equal? (run-3-prog-typecheck '(cond (#t 3)((equal? 5 5) 4)(else 1))) 3)
	      (printf "succeeded: (run-3-prog-typecheck '(cond (#t 3)((equal? 5 5) 4)(else 1)))\n"))
      (when   (equal? (run-3-prog-typecheck '(cond (#f 3)((equal? 5 5) (- 5 3 1))(else 9))) 1)
	      (printf "succeeded: (run-3-prog-typecheck '(cond (#f 3)((equal? 5 5) (- 5 3 1))(else 9)))\n"))
      (when   (equal? (run-3-prog-typecheck '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else (* 10 9)))) 90)
	      (printf "succeeded: (run-3-prog-typecheck '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else (* 10 9))))\n"))
      (when   (equal? (run-3-prog-typecheck '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else 9))) 9)
	      (printf "succeeded: (run-3-prog-typecheck '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else 9)))\n"))
      (when   (equal? (run-3-prog-typecheck '(cond (else 2))) '2)
	      (printf "succeeded: (run-3-prog-typecheck '(cond (else 2)))\n"))
      ;;; Testing for mathematical operator primitives
      (when   (equal? (run-3-prog-typecheck '(+)) 0)
	      (printf "succeeded: (run-3-prog-typecheck '(+))\n"))
      (when   (equal? (run-3-prog-typecheck '(+ 1)) 1)
	      (printf "succeeded: (run-3-prog-typecheck '(+ 1))\n"))
      (when   (equal? (run-3-prog-typecheck '(+ 1 10)) 11)
	      (printf "succeeded: (run-3-prog-typecheck '(+ 1 10))\n"))
      (when   (equal? (run-3-prog-typecheck '(+ 1 10 100)) 111)
	      (printf "succeeded: (run-3-prog-typecheck '(+ 1 10 100))\n"))
      (when   (equal? (run-3-prog-typecheck '(- 5)) -5)
	      (printf "succeeded: (run-3-prog-typecheck '(- 5))\n"))
      (when   (equal? (run-3-prog-typecheck '(- 5 1 2)) 2)
	      (printf "succeeded: (run-3-prog-typecheck '(- 5 1 2))\n"))
      (when   (equal? (run-3-prog-typecheck '(*)) 1)
	      (printf "succeeded: (run-3-prog-typecheck '(*))\n"))
      (when   (equal? (run-3-prog-typecheck '(* 5)) 5)
	      (printf "succeeded: (run-3-prog-typecheck '(* 5))\n"))
      (when   (equal? (run-3-prog-typecheck '(* 5 2 1)) 10)
	      (printf "succeeded: (run-3-prog-typecheck '(* 5 2 1))\n"))
      (when   (equal? (run-3-prog-typecheck '(* 5 2 100 0)) 0)
	      (printf "succeeded: (run-3-prog-typecheck '(* 5 2 100 0))\n"))
      (when   (equal? (run-3-prog-typecheck '(/ 5)) 1/5)
	      (printf "succeeded: (run-3-prog-typecheck '(/ 5))\n"))
      (when   (equal? (run-3-prog-typecheck '(/ 10 5)) 2)
	      (printf "succeeded: (run-3-prog-typecheck '(/ 10 5))\n"))
      (when   (equal? (run-3-prog-typecheck '(/ 1000 20 5)) 10)
	      (printf "succeeded: (run-3-prog-typecheck '(/ 1000 20 5))\n"))
      ;;; Testing for scheme list primitives
      (when   (equal? (run-3-prog-typecheck '(car (cons 1 2))) 1)
	      (printf "succeeded: (run-3-prog-typecheck '(car (cons 1 2)))\n"))
      (when   (equal? (run-3-prog-typecheck '(cdr (cons 1 2))) '2)
	      (printf "succeeded: (run-3-prog-typecheck '(cdr (cons 1 2)))\n"))
      (when   (equal? (run-3-prog-typecheck '(car '(1 2))) 1)
	      (printf "succeeded: (run-3-prog-typecheck '(car '(1 2)))\n"))
      (when   (equal? (run-3-prog-typecheck '(cdr '(1 2))) '(2))
	      (printf "succeeded: (run-3-prog-typecheck '(cdr '(1 2)))\n"))
      (when   (equal? (run-3-prog-typecheck '(list 1 2 3)) '(1 2 3))
	      (printf "succeeded: (run-3-prog-typecheck '(list 1 2 3))\n"))
      (when   (equal? (run-3-prog-typecheck '(list (list 1 2 3))) '((1 2 3)))
	      (printf "succeeded: (run-3-prog-typecheck '(list (list 1 2 3)))\n"))
      ;;; Testing for call/cc
      (when   (equal? (run-3-prog-typecheck '(+ 5 (call/cc (lambda (k) 10)))) 15)
	      (printf "succeeded: (run-3-prog-typecheck '(+ 5 (call/cc (lambda (k) 10))))\n"))
      (when   (equal? (run-3-prog-typecheck '(+ 5 (call/cc (lambda (k) (k 10))))) 15)
	      (printf "succeeded: (run-3-prog-typecheck '(+ 5 (call/cc (lambda (k) (k 10)))))\n"))
      (when   (equal? (run-3-prog-typecheck '(+ 5 (call/cc (lambda (k) (/ (k 10) 0))))) 15)
	      (printf "succeeded: (run-3-prog-typecheck '(+ 5 (call/cc (lambda (k) (/ (k 10) 0)))))\n"))
      (when   (equal? (run-3-prog-typecheck '(/ 50 (call/cc (lambda (k) (+ 0 (k 25)))))) 2)
	      (printf "succeeded: (run-3-prog-typecheck '(/ 50 (call/cc (lambda (k) (+ 0 (k 25))))))\n"))
      ;;; Testing for simple cases of apply
      (when   (equal? (run-3-prog-typecheck '(apply + '(1 2 3))) 6)
	      (printf "succeeded: (run-3-prog-typecheck '(apply + '(1 2 3)))\n"))
      (when   (equal? (run-3-prog-typecheck '(apply (lambda (x) x) '(10))) 10)
	      (printf "succeeded: (run-3-prog-typecheck '(apply (lambda (x) x) '(10)))\n"))
      (when   (equal? (run-3-prog-typecheck '(apply * '(10 5 -1))) -50)
	      (printf "succeeded: (run-3-prog-typecheck '(apply * '(10 5 -1)))\n"))
      (when   (equal? (run-3-prog-typecheck '(apply (lambda () 1) '())) 1)
	      (printf "succeeded: (run-3-prog-typecheck '(apply (lambda () 1) '()))\n"))
      ;;; Testing for more complex cases of apply
      (when   (equal? (run-3-prog-typecheck '(apply apply (list + (list 5 3 1)))) 9)
	      (printf "succeeded: (run-3-prog-typecheck '(apply apply (list + (list 5 3 1))))\n"))
      (when   (equal? (run-3-prog-typecheck '(apply apply (list (lambda (a b) (+ a (+ b 1))) (list 10 20)))) 31)
	      (printf "succeeded: (run-3-prog-typecheck '(apply apply (list (lambda (a b) (+ a (+ b 1))) (list 10 20))))\n"))
      (when   (equal? (run-3-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) 10))))) 11)
	      (printf "succeeded: (run-3-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) 10)))))\n"))
      (when   (equal? (run-3-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) (k 10)))))) 11)
	      (printf "succeeded: (run-3-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) (k 10))))))\n"))
      (when   (equal? (run-3-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) (/ (k 10) 0)))))) 11)
	      (printf "succeeded: (run-3-prog-typecheck '(+ 1 (apply call/cc (list (lambda (k) (/ (k 10) 0))))))\n"))
      ;;; Testing for letrec expressions

      ;; Testing using factorial function
      (when   (equal? (run-3-prog-typecheck '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 5))) 120)
	      (printf "succeeded: (run-3-prog-typecheck '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 5)))\n"))
      (when   (equal? (run-3-prog-typecheck '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 7))) 5040)
	      (printf "succeeded: (run-3-prog-typecheck '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 7)))\n"))
      
      ;; Testing using ternary preternary postternary where result is expected to be #t
      (when   (equal? (run-3-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (ternary 12))) #t)
	      (printf "succeeded: (run-3-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(ternary 12)))\n"))
      (when   (equal? (run-3-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (preternary 5))) #t)
	      (printf "succeeded: (run-3-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(preternary 5)))\n"))
      (when   (equal? (run-3-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (postternary 31))) #t)
	      (printf "succeeded: (run-3-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(postternary 31)))\n"))
      
      ;; Testing using ternary preternary postternary where result is expected to be #f
      (when   (equal? (run-3-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (ternary 10))) #f)
	      (printf "succeeded: (run-3-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(ternary 10)))\n"))
      (when   (equal? (run-3-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (preternary 21))) #f)
	      (printf "succeeded: (run-3-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(preternary 21)))\n"))
      (when   (equal? (run-3-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (postternary 20))) #f)
	      (printf "succeeded: (run-3-prog-typecheck '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(postternary 20)))\n"))

      ;; Testing using even odd where result is expected to be #t
      (when   (equal? (run-3-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					    (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				     (even 10))) #t)
	      (printf "succeeded: (run-3-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(even 10)))\n"))
      (when   (equal? (run-3-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					    (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				     (odd 7))) #t)
	      (printf "succeeded: (run-3-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(odd 7)))\n"))

      ;; Testing using even odd where result is expected to be #f
      (when (equal? (run-3-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					  (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				   (even 9))) #f)
	    (printf "succeeded: (run-3-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(even 9)))\n"))
      (when (equal? (run-3-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					  (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				   (odd 6))) #f)
	    (printf "succeeded: (run-3-prog-typecheck '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(odd 6)))\n"))
      )))

;;; Defining tests for run-star-prog-typecheck parameterized by n.

;;; normal version
(define test-run-star-prog-typecheck
  (lambda (n)
    (begin
      ;;; Testing for base values
      (unless (equal? (run-star-prog-typecheck n 0) 0)
	      (printf "failed: (run-star-prog-typecheck ~s 0)\n" n))
      (unless (equal? (run-star-prog-typecheck n '#f) #f)
	      (printf "failed: (run-star-prog-typecheck ~s '#f)\n" n))
      (unless (equal? (run-star-prog-typecheck n '#\f) #\f)
	      (printf "failed: (run-star-prog-typecheck ~s '#\f)\n" n))
      (unless (equal? (run-star-prog-typecheck n "scheme_capstone") "scheme_capstone")
	      (printf "failed: (run-star-prog-typecheck ~s \"scheme_capstone\")\n" n))
      (unless (equal? (run-star-prog-typecheck n '()) '())
	      (printf "failed: (run-star-prog-typecheck ~s '())\n" n))
      ;;; Testing for if expressions
      (unless (equal? (run-star-prog-typecheck n '(if #t 1 2)) 1)
	      (printf "failed: (run-star-prog-typecheck ~s '(if #t 1 2))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(if #f 1 2)) 2)
	      (printf "failed: (run-star-prog-typecheck ~s '(if #f 1 2))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(if 0 1 2)) 1)
	      (printf "failed: (run-star-prog-typecheck ~s '(if 0 1 2))\n" n))
      (unless (equal? (run-star-prog-typecheck n '((lambda (x) x) 1)) 1)
	      (printf "failed: (run-star-prog-typecheck ~s '((lambda (x) x) 1))\n" n))
      ;;; Testing for lambda expressions
      (unless (equal? (run-star-prog-typecheck n '((lambda (x y) x) 1 2)) 1)
	      (printf "failed: (run-star-prog-typecheck ~s '((lambda (x y) x) 1 2))\n" n))
      (unless (equal? (run-star-prog-typecheck n '((lambda (x y) x) 1 2)) 1)
	      (printf "failed: (run-star-prog-typecheck ~s ((lambda (x y) x) 1 2))\n" n))
      (unless (equal? (run-star-prog-typecheck n '((lambda (x y) y) 1 2)) 2)
	      (printf "failed: (run-star-prog-typecheck ~s ((lambda (x y) y) 1 2))\n" n))
      (unless (equal? (run-star-prog-typecheck n '((lambda xs xs) 1 2)) '(1 2))
	      (printf "failed: (run-star-prog-typecheck ~s '((lambda xs xs) 1 2))\n" n))
      (unless (equal? (run-star-prog-typecheck n '((lambda (x . xs) xs) 1 2 3)) '(2 3))
	      (printf "failed: (run-star-prog-typecheck ~s '((lambda (x . xs) xs) 1 2 3))\n" n))
      ;;; Testing for let expressions
      (unless (equal? (run-star-prog-typecheck n '(let () 2)) 2)
	      (printf "failed: (run-star-prog-typecheck ~s '(let () 2))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(let ((x 1)) x)) 1)
	      (printf "failed: (run-star-prog-typecheck ~s '(let ((x 1)) x))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(let ((x 1) (y 2)) x)) 1)
	      (printf "failed: (run-star-prog-typecheck ~s '(let ((x 1) (y 2)) x))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(let ((x 1) (y 2)) y)) 2)
	      (printf "failed: (run-star-prog-typecheck ~s '(let ((x 1) (y 2)) y))\n" n))
      ;;; Testing for quote expressions and nested quote expressions
      (unless (equal? (run-star-prog-typecheck n ''(if #t 1 2)) '(if #t 1 2))
	      (printf "failed: (run-star-prog-typecheck ~s ''(if #t 1 2))\n" n))
      (unless (equal? (run-star-prog-typecheck n ''((lambda (x y) x) 1 2))'((lambda (x y) x) 1 2))
	      (printf "failed: (run-star-prog-typecheck ~s ''((lambda (x y) x) 1 2))\n" n))
      (unless (equal? (run-star-prog-typecheck n '''(if #t 1 2)) ''(if #t 1 2))
	      (printf "failed: (run-star-prog-typecheck ~s '''(if #t 1 2))\n" n))
      (unless (equal? (run-star-prog-typecheck n '''((lambda (x y) x) 1 2))''((lambda (x y) x) 1 2))
	      (printf "failed: (run-star-prog-typecheck ~s '''((lambda (x y) x) 1 2))\n" n))
      ;;; Testing for cond expression
      (unless (equal? (run-star-prog-typecheck n '(cond (#t 3)(#f 4)(else 1))) 3)
	      (printf "failed: (run-star-prog-typecheck ~s '(cond (#t 3)(#f 4)(else 1)))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(cond (#f 3)((equal? 5 5) 4)(else 1))) 4)
	      (printf "failed: (run-star-prog-typecheck ~s '(cond (#f 3)((equal? 5 5) 4)(else 1)))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(cond (#t 3)((equal? 5 5) 4)(else 1))) 3)
	      (printf "failed: (run-star-prog-typecheck ~s '(cond (#t 3)((equal? 5 5) 4)(else 1)))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(cond (#f 3)((equal? 5 5) (- 5 3 1))(else 9))) 1)
	      (printf "failed: (run-star-prog-typecheck ~s '(cond (#f 3)((equal? 5 5) (- 5 3 1))(else 9)))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else (* 10 9)))) 90)
	      (printf "failed: (run-star-prog-typecheck ~s '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else (* 10 9))))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else 9))) 9)
	      (printf "failed: (run-star-prog-typecheck ~s '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else 9)))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(cond (else 2))) '2)
	      (printf "failed: (run-star-prog-typecheck ~s '(cond (else 2)))\n" n))
      ;;; Testing for mathematical operator primitives
      (unless (equal? (run-star-prog-typecheck n '(+)) 0)
	      (printf "failed: (run-star-prog-typecheck ~s '(+))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(+ 1)) 1)
	      (printf "failed: (run-star-prog-typecheck ~s '(+ 1))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(+ 1 10)) 11)
	      (printf "failed: (run-star-prog-typecheck ~s '(+ 1 10))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(+ 1 10 100)) 111)
	      (printf "failed: (run-star-prog-typecheck ~s '(+ 1 10 100))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(- 5)) -5)
	      (printf "failed: (run-star-prog-typecheck ~s '(- 5))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(- 5 1 2)) 2)
	      (printf "failed: (run-star-prog-typecheck ~s '(- 5 1 2))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(*)) 1)
	      (printf "failed: (run-star-prog-typecheck ~s '(*))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(* 5)) 5)
	      (printf "failed: (run-star-prog-typecheck ~s '(* 5))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(* 5 2 1)) 10)
	      (printf "failed: (run-star-prog-typecheck ~s '(* 5 2 1))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(* 5 2 100 0)) 0)
	      (printf "failed: (run-star-prog-typecheck ~s '(* 5 2 100 0))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(/ 5)) 1/5)
	      (printf "failed: (run-star-prog-typecheck ~s '(/ 5))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(/ 10 5)) 2)
	      (printf "failed: (run-star-prog-typecheck ~s '(/ 10 5))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(/ 1000 20 5)) 10)
	      (printf "failed: (run-star-prog-typecheck ~s '(/ 1000 20 5))\n" n))
      ;;; Testing for scheme list primitives
      (unless (equal? (run-star-prog-typecheck n '(car (cons 1 2))) 1)
	      (printf "failed: (run-star-prog-typecheck ~s '(car (cons 1 2)))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(cdr (cons 1 2))) '2)
	      (printf "failed: (run-star-prog-typecheck ~s '(cdr (cons 1 2)))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(car '(1 2))) 1)
	      (printf "failed: (run-star-prog-typecheck ~s '(car '(1 2)))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(cdr '(1 2))) '(2))
	      (printf "failed: (run-star-prog-typecheck ~s '(cdr '(1 2)))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(list 1 2 3)) '(1 2 3))
	      (printf "failed: (run-star-prog-typecheck ~s '(list 1 2 3))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(list (list 1 2 3))) '((1 2 3)))
	      (printf "failed: (run-star-prog-typecheck ~s '(list (list 1 2 3)))\n" n))
      ;;; Testing for call/cc
      (unless (equal? (run-star-prog-typecheck n '(+ 5 (call/cc (lambda (k) 10)))) 15)
	      (printf "failed: (run-star-prog-typecheck ~s '(+ 5 (call/cc (lambda (k) 10))))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(+ 5 (call/cc (lambda (k) (k 10))))) 15)
	      (printf "failed: (run-star-prog-typecheck ~s '(+ 5 (call/cc (lambda (k) (k 10)))))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(+ 5 (call/cc (lambda (k) (/ (k 10) 0))))) 15)
	      (printf "failed: (run-star-prog-typecheck ~s '(+ 5 (call/cc (lambda (k) (/ (k 10) 0)))))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(/ 50 (call/cc (lambda (k) (+ 0 (k 25)))))) 2)
	      (printf "failed: (run-star-prog-typecheck ~s '(/ 50 (call/cc (lambda (k) (+ 0 (k 25))))))\n" n))
      ;;; Testing for simple cases of apply
      (unless (equal? (run-star-prog-typecheck n '(apply + '(1 2 3))) 6)
	      (printf "failed: (run-star-prog-typecheck ~s '(apply + '(1 2 3)))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(apply (lambda (x) x) '(10))) 10)
	      (printf "failed: (run-star-prog-typecheck ~s '(apply (lambda (x) x) '(10)))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(apply * '(10 5 -1))) -50)
	      (printf "failed: (run-star-prog-typecheck ~s '(apply * '(10 5 -1)))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(apply (lambda () 1) '())) 1)
	      (printf "failed: (run-star-prog-typecheck ~s '(apply (lambda () 1) '()))\n" n))
      ;;; Testing for more complex cases of apply
      (unless (equal? (run-star-prog-typecheck n '(apply apply (list + (list 5 3 1)))) 9)
	      (printf "failed: (run-star-prog-typecheck ~s '(apply apply (list + (list 5 3 1))))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(apply apply (list (lambda (a b) (+ a (+ b 1))) (list 10 20)))) 31)
	      (printf "failed: (run-star-prog-typecheck ~s '(apply apply (list (lambda (a b) (+ a (+ b 1))) (list 10 20))))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(+ 1 (apply call/cc (list (lambda (k) 10))))) 11)
	      (printf "failed: (run-star-prog-typecheck ~s '(+ 1 (apply call/cc (list (lambda (k) 10)))))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(+ 1 (apply call/cc (list (lambda (k) (k 10)))))) 11)
	      (printf "failed: (run-star-prog-typecheck ~s '(+ 1 (apply call/cc (list (lambda (k) (k 10))))))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(+ 1 (apply call/cc (list (lambda (k) (/ (k 10) 0)))))) 11)
	      (printf "failed: (run-star-prog-typecheck ~s '(+ 1 (apply call/cc (list (lambda (k) (/ (k 10) 0))))))\n" n))
      ;;; Testing for letrec expressions

      ;; Testing using factorial function
      (unless (equal? (run-star-prog-typecheck n '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 5))) 120)
	      (printf "failed: (run-star-prog-typecheck ~s '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 5)))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 7))) 5040)
	      (printf "failed: (run-star-prog-typecheck ~s '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 7)))\n" n))
      
      ;; Testing using ternary preternary postternary where result is expected to be #t
      (unless (equal? (run-star-prog-typecheck n '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (ternary 12))) #t)
	      (printf "failed: (run-star-prog-typecheck ~s '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(ternary 12)))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (preternary 5))) #t)
	      (printf "failed: (run-star-prog-typecheck ~s '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(preternary 5)))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (postternary 31))) #t)
	      (printf "failed: (run-star-prog-typecheck ~s '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(postternary 31)))\n" n))
      
      ;; Testing using ternary preternary postternary where result is expected to be #f
      (unless (equal? (run-star-prog-typecheck n '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (ternary 10))) #f)
	      (printf "failed: (run-star-prog-typecheck ~s '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(ternary 10)))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (preternary 21))) #f)
	      (printf "failed: (run-star-prog-typecheck ~s '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(preternary 21)))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (postternary 20))) #f)
	      (printf "failed: (run-star-prog-typecheck ~s '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(postternary 20)))\n" n))
      
      ;; Testing using even odd where result is expected to be #t
      (unless (equal? (run-star-prog-typecheck n '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					    (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				     (even 10))) #t)
	      (printf "failed: (run-star-prog-typecheck ~s '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(even 10)))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					    (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				     (odd 7))) #t)
	      (printf "failed: (run-star-prog-typecheck ~s '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(odd 7)))\n" n))

      ;; Testing using even odd where result is expected to be #f
      (unless (equal? (run-star-prog-typecheck n '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					    (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				     (even 9))) #f)
	      (printf "failed: (run-star-prog-typecheck ~s '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(even 9)))\n" n))
      (unless (equal? (run-star-prog-typecheck n '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					    (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				     (odd 6))) #f)
	      (printf "failed: (run-star-prog-typecheck ~s '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(odd 6)))\n" n))
      )))

;;; "verbose" version that prints out messages if test is fine. Hence, no error messages means that tests are NOT fine
(define test-verbose-run-star-prog-typecheck
  (lambda (n)
    (begin
      ;;; Testing for base values
      (when   (equal? (run-star-prog-typecheck n 0) 0)
	      (printf "succeeded: (run-star-prog-typecheck ~s 0)\n" n))
      (when   (equal? (run-star-prog-typecheck n '#f) #f)
	      (printf "succeeded: (run-star-prog-typecheck ~s '#f)\n" n))
      (when   (equal? (run-star-prog-typecheck n '#\f) #\f)
	      (printf "succeeded: (run-star-prog-typecheck ~s '#\f)\n" n))
      (when   (equal? (run-star-prog-typecheck n "scheme_capstone") "scheme_capstone")
	      (printf "succeeded: (run-star-prog-typecheck ~s \"scheme_capstone\")\n" n))
      (when   (equal? (run-star-prog-typecheck n '()) '())
	      (printf "succeeded: (run-star-prog-typecheck ~s '())\n" n))
      ;;; Testing for if expressions
      (when   (equal? (run-star-prog-typecheck n '(if #t 1 2)) 1)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(if #t 1 2))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(if #f 1 2)) 2)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(if #f 1 2))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(if 0 1 2)) 1)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(if 0 1 2))\n" n))
      (when   (equal? (run-star-prog-typecheck n '((lambda (x) x) 1)) 1)
	      (printf "succeeded: (run-star-prog-typecheck ~s '((lambda (x) x) 1))\n" n))
      ;;; Testing for lambda expressions
      (when   (equal? (run-star-prog-typecheck n '((lambda (x y) x) 1 2)) 1)
	      (printf "succeeded: (run-star-prog-typecheck ~s '((lambda (x y) x) 1 2))\n" n))
      (when   (equal? (run-star-prog-typecheck n '((lambda (x y) x) 1 2)) 1)
	      (printf "succeeded: (run-star-prog-typecheck ~s ((lambda (x y) x) 1 2))\n" n))
      (when   (equal? (run-star-prog-typecheck n '((lambda (x y) y) 1 2)) 2)
	      (printf "succeeded: (run-star-prog-typecheck ~s ((lambda (x y) y) 1 2))\n" n))
      (when   (equal? (run-star-prog-typecheck n '((lambda xs xs) 1 2)) '(1 2))
	      (printf "succeeded: (run-star-prog-typecheck ~s '((lambda xs xs) 1 2))\n" n))
      (when   (equal? (run-star-prog-typecheck n '((lambda (x . xs) xs) 1 2 3)) '(2 3))
	      (printf "succeeded: (run-star-prog-typecheck ~s '((lambda (x . xs) xs) 1 2 3))\n" n))
      ;;; Testing for let expressions
      (when   (equal? (run-star-prog-typecheck n '(let () 2)) 2)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(let () 2))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(let ((x 1)) x)) 1)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(let ((x 1)) x))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(let ((x 1) (y 2)) x)) 1)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(let ((x 1) (y 2)) x))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(let ((x 1) (y 2)) y)) 2)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(let ((x 1) (y 2)) y))\n" n))
      ;;; Testing for quote expressions and nested quote expressions
      (when   (equal? (run-star-prog-typecheck n ''(if #t 1 2)) '(if #t 1 2))
	      (printf "succeeded: (run-star-prog-typecheck ~s ''(if #t 1 2))\n" n))
      (when   (equal? (run-star-prog-typecheck n ''((lambda (x y) x) 1 2))'((lambda (x y) x) 1 2))
	      (printf "succeeded: (run-star-prog-typecheck ~s ''((lambda (x y) x) 1 2))\n" n))
      (when   (equal? (run-star-prog-typecheck n '''(if #t 1 2)) ''(if #t 1 2))
	      (printf "succeeded: (run-star-prog-typecheck ~s '''(if #t 1 2))\n" n))
      (when   (equal? (run-star-prog-typecheck n '''((lambda (x y) x) 1 2))''((lambda (x y) x) 1 2))
	      (printf "succeeded: (run-star-prog-typecheck ~s '''((lambda (x y) x) 1 2))\n" n))
      ;;; Testing for cond expression
      (when   (equal? (run-star-prog-typecheck n '(cond (#t 3)(#f 4)(else 1))) 3)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(cond (#t 3)(#f 4)(else 1)))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(cond (#f 3)((equal? 5 5) 4)(else 1))) 4)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(cond (#f 3)((equal? 5 5) 4)(else 1)))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(cond (#t 3)((equal? 5 5) 4)(else 1))) 3)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(cond (#t 3)((equal? 5 5) 4)(else 1)))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(cond (#f 3)((equal? 5 5) (- 5 3 1))(else 9))) 1)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(cond (#f 3)((equal? 5 5) (- 5 3 1))(else 9)))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else (* 10 9)))) 90)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else (* 10 9))))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else 9))) 9)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(cond (#f 3)((equal? 5 4) (- 5 3 1))(else 9)))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(cond (else 2))) '2)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(cond (else 2)))\n" n))
      ;;; Testing for mathematical operator primitives
      (when   (equal? (run-star-prog-typecheck n '(+)) 0)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(+))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(+ 1)) 1)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(+ 1))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(+ 1 10)) 11)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(+ 1 10))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(+ 1 10 100)) 111)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(+ 1 10 100))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(- 5)) -5)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(- 5))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(- 5 1 2)) 2)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(- 5 1 2))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(*)) 1)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(*))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(* 5)) 5)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(* 5))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(* 5 2 1)) 10)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(* 5 2 1))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(* 5 2 100 0)) 0)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(* 5 2 100 0))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(/ 5)) 1/5)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(/ 5))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(/ 10 5)) 2)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(/ 10 5))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(/ 1000 20 5)) 10)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(/ 1000 20 5))\n" n))
      ;;; Testing for scheme list primitives
      (when   (equal? (run-star-prog-typecheck n '(car (cons 1 2))) 1)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(car (cons 1 2)))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(cdr (cons 1 2))) '2)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(cdr (cons 1 2)))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(car '(1 2))) 1)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(car '(1 2)))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(cdr '(1 2))) '(2))
	      (printf "succeeded: (run-star-prog-typecheck ~s '(cdr '(1 2)))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(list 1 2 3)) '(1 2 3))
	      (printf "succeeded: (run-star-prog-typecheck ~s '(list 1 2 3))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(list (list 1 2 3))) '((1 2 3)))
	      (printf "succeeded: (run-star-prog-typecheck ~s '(list (list 1 2 3)))\n" n))
      ;;; Testing for call/cc
      (when   (equal? (run-star-prog-typecheck n '(+ 5 (call/cc (lambda (k) 10)))) 15)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(+ 5 (call/cc (lambda (k) 10))))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(+ 5 (call/cc (lambda (k) (k 10))))) 15)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(+ 5 (call/cc (lambda (k) (k 10)))))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(+ 5 (call/cc (lambda (k) (/ (k 10) 0))))) 15)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(+ 5 (call/cc (lambda (k) (/ (k 10) 0)))))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(/ 50 (call/cc (lambda (k) (+ 0 (k 25)))))) 2)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(/ 50 (call/cc (lambda (k) (+ 0 (k 25))))))\n" n))
      ;;; Testing for simple cases of apply
      (when   (equal? (run-star-prog-typecheck n '(apply + '(1 2 3))) 6)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(apply + '(1 2 3)))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(apply (lambda (x) x) '(10))) 10)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(apply (lambda (x) x) '(10)))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(apply * '(10 5 -1))) -50)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(apply * '(10 5 -1)))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(apply (lambda () 1) '())) 1)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(apply (lambda () 1) '()))\n" n))
      ;;; Testing for more complex cases of apply
      (when   (equal? (run-star-prog-typecheck n '(apply apply (list + (list 5 3 1)))) 9)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(apply apply (list + (list 5 3 1))))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(apply apply (list (lambda (a b) (+ a (+ b 1))) (list 10 20)))) 31)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(apply apply (list (lambda (a b) (+ a (+ b 1))) (list 10 20))))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(+ 1 (apply call/cc (list (lambda (k) 10))))) 11)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(+ 1 (apply call/cc (list (lambda (k) 10)))))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(+ 1 (apply call/cc (list (lambda (k) (k 10)))))) 11)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(+ 1 (apply call/cc (list (lambda (k) (k 10))))))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(+ 1 (apply call/cc (list (lambda (k) (/ (k 10) 0)))))) 11)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(+ 1 (apply call/cc (list (lambda (k) (/ (k 10) 0))))))\n" n))
      ;;; Testing for letrec expressions

      ;; Testing using factorial function
      (when   (equal? (run-star-prog-typecheck n '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 5))) 120)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 5)))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 7))) 5040)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(letrec ((fac (lambda (n) (if (= n 0) 1 (* n (fac (- n 1))))))) (fac 7)))\n" n))
      
      ;; Testing using ternary preternary postternary where result is expected to be #t
      (when   (equal? (run-star-prog-typecheck n '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (ternary 12))) #t)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(ternary 12)))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (preternary 5))) #t)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(preternary 5)))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (postternary 31))) #t)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(postternary 31)))\n" n))
      
      ;; Testing using ternary preternary postternary where result is expected to be #f
      (when   (equal? (run-star-prog-typecheck n '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (ternary 10))) #f)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(ternary 10)))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (preternary 21))) #f)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(preternary 21)))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))
					    (postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))
					    (preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))
				     (postternary 20))) #f)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(letrec ((ternary (lambda (n) (if (= n 0) #t (preternary (- n 1)))))(postternary (lambda (n) (if (= n 0) #f (ternary (- n 1)))))(preternary (lambda (n) (if (= n 0) #f (postternary (- n 1))))))(postternary 20)))\n" n))

      ;; Testing using even odd where result is expected to be #t
      (when   (equal? (run-star-prog-typecheck n '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					    (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				     (even 10))) #t)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(even 10)))\n" n))
      (when   (equal? (run-star-prog-typecheck n '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					    (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				     (odd 7))) #t)
	      (printf "succeeded: (run-star-prog-typecheck ~s '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(odd 7)))\n" n))

      ;; Testing using even odd where result is expected to be #f
      (when (equal? (run-star-prog-typecheck n '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					  (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				   (even 9))) #f)
	    (printf "succeeded: (run-star-prog-typecheck ~s '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(even 9)))\n" n))
      (when (equal? (run-star-prog-typecheck n '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))
					  (odd (lambda (n) (if (= n 0) #f (even (- n 1))))))
				   (odd 6))) #f)
	    (printf "succeeded: (run-star-prog-typecheck ~s '(letrec ((even (lambda (n) (if (= n 0) #t (odd (- n 1)))))(odd (lambda (n) (if (= n 0) #t (even (- n 1))))))(odd 6)))\n" n))
      )))
